import{j as e}from"./ui-vendor-_s0klCrL.js";import{b as r,u as Na,L as ya}from"./react-vendor-C7VPsBAG.js";import{c as Ce,aq as Us,F as ae,B as n,ar as Ca,as as ka,t,ap as ee,o as ye,Y as Sa,at as Fs,L as Xe,au as Pa,u as Da,r as u,I as T,s as Ve,v as Ge,w as Je,x as Ke,y as Le,a5 as Ua,av as ie,a0 as be,g as Qe,ao as Fa,A as Es,C as _e,k as es,am as Ea,h as Ta,i as za,j as Aa,ah as Ma,aj as _}from"./index-BLJ_ytcB.js";import{D as H,a as W,b as Z,c as Y,d as se,e as Ts,f as ss}from"./dialog-BPAt-TF-.js";import{A as as,a as rs,b as ts,c as ls,d as is,e as ns,f as cs,g as os}from"./alert-dialog-CQ2ww59i.js";import{C as zs}from"./circle-check-big-B1R9t0pA.js";import{E as $e}from"./eye-CaJoh2v9.js";import{P as La}from"./progress-CS8SLfk3.js";import{S as As}from"./square-check-big-CO7qm0JX.js";import{S as Ms}from"./square-Bkony4Hd.js";import{E as Ra}from"./eye-off-BZjFRRGX.js";import{S as Re}from"./square-pen-CRfgceVq.js";import{I as Ls}from"./image-BxQwejDH.js";import{S as Ne}from"./save-0LRYMEmV.js";import{P as $a}from"./plus-k2bBbm5g.js";import"./utils-vendor-DYGWDIxX.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=Ce("FileArchive",[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=Ce("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=Ce("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=Ce("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=Ce("MousePointer2",[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]]);function Ha({isOpen:S,onClose:k,onConfirm:P,initialPages:A,chapterNumber:$,naturalSortConfidence:i,requiresManualReorder:X,chapterTitle:M}){const[b,o]=r.useState(A),[F,d]=r.useState(null),[z,E]=r.useState(-1),[I,B]=r.useState(!1),[m,f]=r.useState(null);r.useEffect(()=>{S&&(o(A),B(!1),d(null),E(-1),f(null))},[S,A]);const ne=(c,p)=>{const w={index:p,page:b[p]};d(w),c.dataTransfer.effectAllowed="move",c.dataTransfer.setData("text/plain",JSON.stringify(w)),c.currentTarget.style.opacity="0.5"},V=c=>{c.currentTarget.style.opacity="1",d(null),E(-1)},ce=(c,p)=>{c.preventDefault(),c.dataTransfer.dropEffect="move",E(p)},re=c=>{c.currentTarget.contains(c.relatedTarget)||E(-1)},pe=(c,p)=>{if(c.preventDefault(),!F)return;const w=F.index;if(w===p){E(-1);return}const U=[...b],[xe]=U.splice(w,1);U.splice(p,0,xe),o(U),B(!0),E(-1),t({title:"Page Reordered",description:`Moved page ${w+1} to position ${p+1}`})},G=()=>{o(A),B(!1),t({title:"Order Reset",description:"Pages have been reset to original order"})},J=()=>{P(b),k()},D=c=>c>=.8?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":c>=.6?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",Ie=c=>c>=.8?"High Confidence":c>=.6?"Medium Confidence":"Low Confidence";return e.jsxs(e.Fragment,{children:[e.jsx(H,{open:S,onOpenChange:k,children:e.jsxs(W,{className:"max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs(Z,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[X?e.jsx(Us,{className:"w-5 h-5 text-amber-500"}):e.jsx(zs,{className:"w-5 h-5 text-green-500"}),"Page Order Review - Chapter ",$,M&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",M,")"]})]}),e.jsxs(se,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{children:"Natural sorting confidence:"}),e.jsxs(ae,{className:D(i),children:[Ie(i)," (",Math.round(i*100),"%)"]})]}),X?e.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[e.jsx(Us,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"The automatic page ordering may not be correct. Please review and reorder if needed."})]}):e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(zs,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Page order looks good! You can still reorder pages if needed."})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Oa,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Drag and drop pages to reorder them. Click on a page to preview it."})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-6 gap-4 p-2",children:b.map((c,p)=>e.jsxs("div",{draggable:!0,onDragStart:w=>ne(w,p),onDragEnd:V,onDragOver:w=>ce(w,p),onDragLeave:re,onDrop:w=>pe(w,p),className:`
                      relative group cursor-move border-2 rounded-lg overflow-hidden
                      transition-all duration-200 hover:shadow-lg
                      ${z===p?"border-primary bg-primary/10 scale-105":"border-border hover:border-primary/50"}
                      ${F?.index===p?"opacity-50":""}
                    `,children:[e.jsx("div",{className:"absolute top-2 left-2 z-10",children:e.jsx(ae,{variant:"secondary",className:"text-xs font-bold bg-black/70 text-white",children:p+1})}),e.jsx("div",{className:"absolute top-2 right-2 z-10 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-black/70 rounded p-1",children:e.jsx(Ba,{className:"w-4 h-4 text-white"})})}),e.jsxs("div",{className:"aspect-[3/4] bg-gray-100 dark:bg-gray-800 relative cursor-pointer",onClick:()=>f(c),children:[e.jsx("img",{src:c,alt:`Page ${p+1}`,className:"w-full h-full object-cover",onError:w=>{w.target.style.display="none";const U=w.target.parentElement;U&&(U.innerHTML='<div class="flex items-center justify-center h-full text-muted-foreground"><span>Failed to load</span></div>')}}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:e.jsx(n,{size:"sm",variant:"secondary",className:"pointer-events-none",children:e.jsx($e,{className:"w-4 h-4"})})})]}),z===p&&F&&F.index!==p&&e.jsx("div",{className:"absolute inset-0 border-2 border-primary border-dashed bg-primary/20 rounded-lg flex items-center justify-center",children:e.jsx(Ca,{className:"w-6 h-6 text-primary"})})]},`${c}-${p}`))})})}),e.jsxs(Ts,{className:"flex-row justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{variant:"outline",onClick:G,disabled:!I,className:"flex items-center gap-2",children:[e.jsx(ka,{className:"w-4 h-4"}),"Reset Order"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[b.length," pages total"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{variant:"outline",onClick:k,children:"Cancel"}),e.jsx(n,{onClick:J,className:"min-w-20",children:I?"Save Changes":"Confirm Order"})]})]})]})}),m&&e.jsx(H,{open:!!m,onOpenChange:()=>f(null),children:e.jsxs(W,{className:"max-w-3xl",children:[e.jsx(Z,{children:e.jsx(Y,{children:"Page Preview"})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:m,alt:"Page preview",className:"max-h-[70vh] max-w-full object-contain",onError:c=>{t({title:"Error",description:"Failed to load page preview",variant:"error"}),f(null)}})}),e.jsx(Ts,{children:e.jsx(n,{onClick:()=>f(null),children:"Close"})})]})})]})}function Wa({open:S,onOpenChange:k,uploadId:P,onComplete:A,onError:$}){const[i,X]=r.useState(null),[M,b]=r.useState(!1),o=r.useRef(null),F=r.useCallback(m=>{if(m===0)return"0 B";const f=1024,ne=["B","KB","MB","GB"],V=Math.floor(Math.log(m)/Math.log(f));return`${parseFloat((m/Math.pow(f,V)).toFixed(1))} ${ne[V]}`},[]),d=r.useCallback(m=>m<60?`${Math.round(m)}s`:m<3600?`${Math.round(m/60)}m`:`${Math.round(m/3600)}h`,[]),z=r.useCallback(async()=>{if(!(!P||!S))try{const m=await fetch(`/api/admin/upload-progress/${P}`,{headers:{"X-Requested-With":"XMLHttpRequest"}});if(m.ok){const f=await m.json();X(f),f.status==="complete"?(b(!1),o.current&&(clearInterval(o.current),o.current=null),setTimeout(()=>{A?.(),k(!1)},2e3)):f.status==="error"&&(b(!1),o.current&&(clearInterval(o.current),o.current=null),$?.(f.error||"Upload failed"))}else m.status===404&&(b(!1),o.current&&(clearInterval(o.current),o.current=null),$?.("Upload session expired"))}catch{}},[P,S,A,$,k]);r.useEffect(()=>{if(o.current&&(clearInterval(o.current),o.current=null,b(!1)),P&&S)return b(!0),X(null),z(),o.current=setInterval(z,500),()=>{o.current&&(clearInterval(o.current),o.current=null),b(!1)}},[P,S]),r.useEffect(()=>()=>{o.current&&(clearInterval(o.current),o.current=null)},[]);const E=async()=>{if(P)try{const m=await fetch(`/api/admin/upload-cancel/${P}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest"}});if(m.ok)b(!1),o.current&&(clearInterval(o.current),o.current=null),k(!1);else{const f=await m.json();b(!1),o.current&&(clearInterval(o.current),o.current=null),k(!1),$?.(f.message||"Failed to cancel upload")}}catch{b(!1),o.current&&(clearInterval(o.current),o.current=null),k(!1),$?.("Network error while cancelling upload")}},I=()=>{if(!i)return e.jsx(Xe,{className:"h-4 w-4 animate-spin"});switch(i.status){case"initializing":case"uploading":return e.jsx(ye,{className:"h-4 w-4"});case"processing":case"extracting":return e.jsx(Ia,{className:"h-4 w-4"});case"finalizing":return e.jsx(Xe,{className:"h-4 w-4 animate-spin"});case"complete":return e.jsx(Fs,{className:"h-4 w-4 text-green-600"});case"error":return e.jsx(Pa,{className:"h-4 w-4 text-red-600"});default:return e.jsx(Xe,{className:"h-4 w-4 animate-spin"})}},B=()=>{if(!i)return"bg-blue-100 text-blue-800";switch(i.status){case"complete":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"error":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";default:return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"}};return e.jsx(H,{open:S,onOpenChange:k,children:e.jsxs(W,{className:"sm:max-w-md",onPointerDownOutside:m=>m.preventDefault(),children:[e.jsxs(Z,{children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[I(),"Upload Progress"]}),e.jsx(se,{children:i?.message||"Preparing your chapter upload..."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:B(),children:i?.status?i.status.charAt(0).toUpperCase()+i.status.slice(1):"Initializing"}),i&&i.status!=="complete"&&i.status!=="error"&&e.jsx(n,{variant:"ghost",size:"sm",onClick:E,className:"h-auto p-1",children:e.jsx(ee,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium",children:[i?.progress||0,"%"]}),i?.totalFiles&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.processedFiles||0," / ",i.totalFiles," files"]})]}),e.jsx(La,{value:i?.progress||0,className:"w-full"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i?.message||"Initializing upload..."}),i?.currentFile&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium",children:"Processing:"})," ",i.currentFile]}),i&&(i.speed||i.estimatedTimeRemaining)&&e.jsxs("div",{className:"flex gap-4 text-xs text-muted-foreground",children:[i.speed&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"h-3 w-3"}),e.jsxs("span",{children:[i.speed.toFixed(1)," MB/s"]})]}),i.estimatedTimeRemaining&&i.estimatedTimeRemaining>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Sa,{className:"h-3 w-3"}),e.jsxs("span",{children:[d(i.estimatedTimeRemaining)," remaining"]})]})]}),i?.details&&e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[i.details.uploadedBytes&&i.details.totalBytes&&e.jsxs("div",{children:[F(i.details.uploadedBytes)," / ",F(i.details.totalBytes)]}),i.details.filesExtracted&&e.jsxs("div",{children:[i.details.filesExtracted," images extracted"]})]}),i?.error&&e.jsx("div",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-950/50 p-2 rounded",children:i.error}),i?.status==="complete"&&e.jsxs("div",{className:"text-sm text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-950/50 p-2 rounded flex items-center gap-2",children:[e.jsx(Fs,{className:"h-4 w-4"}),"Chapter uploaded successfully!"]})]})]})})}const $s=[{value:"ongoing",label:"Ongoing",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"},{value:"completed",label:"Completed",color:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300"},{value:"hiatus",label:"Hiatus",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300"},{value:"cancelled",label:"Cancelled",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}],Za=[{value:"manga",label:"Manga"},{value:"manhwa",label:"Manhwa"},{value:"manhua",label:"Manhua"},{value:"webtoon",label:"Webtoon"}],Ya=["Action","Adventure","Comedy","Drama","Fantasy","Horror","Mystery","Romance","Sci-Fi","Slice of Life","Sports","Supernatural","Thriller","Historical","Psychological","School","Martial Arts","Mecha","Military","Music"];function or(){const{isAdmin:S,isAuthenticated:k}=Da(),[,P]=Na(),[A,$]=r.useState([]),[i,X]=r.useState(!0),[M,b]=r.useState(""),[o,F]=r.useState(!1),[d,z]=r.useState(null),[E,I]=r.useState(null),[B,m]=r.useState(null),[f,ne]=r.useState(!1),[V,ce]=r.useState(null),[re,pe]=r.useState("url"),G=r.useRef(null),J=r.useRef(null),[D,Ie]=r.useState([]),[c,p]=r.useState(!1),[w,U]=r.useState(""),[xe,Be]=r.useState(0),[ge,ke]=r.useState(!1),[ds,qe]=r.useState(""),[Is,Se]=r.useState(!1),[Bs,Oe]=r.useState(null),[qs,Pe]=r.useState(!1),[K,Os]=r.useState(null),[ms,Hs]=r.useState([]),[Ws,hs]=r.useState(!1),[Q,De]=r.useState(""),[Ue,He]=r.useState(""),[fe,We]=r.useState(!1),[j,te]=r.useState(new Set),[q,Fe]=r.useState(null),[Zs,Ee]=r.useState(!1),[Ys,Te]=r.useState(!1),[Xs,us]=r.useState(new Set),[oe,Ze]=r.useState(null),[ze,Ae]=r.useState(null),[ps,xs]=r.useState(!1),[de,me]=r.useState(null),O=r.useRef(null),[Vs,gs]=r.useState(!1),[L,fs]=r.useState(null),[g,je]=r.useState({title:"",description:"",author:"",artist:"",status:"ongoing",type:"manga",genres:[],coverImageUrl:"",rating:void 0,publishedYear:void 0,isAdult:"false",isFeatured:"false",isTrending:"false",isPopularToday:"false",isLatestUpdate:"false",isPinned:"false"}),Gs=s=>{if(!s||s.trim()==="")return;const a=parseInt(s,10);return isNaN(a)?void 0:a},Js=s=>{if(!s||s.trim()==="")return;const a=parseFloat(s);return isNaN(a)?void 0:a},ve=r.useCallback(async()=>{try{X(!0);const s=await fetch("/api/admin/series");if(s.ok){const a=await s.json();$(a)}}catch{t({title:"Error",description:"Failed to fetch series data",variant:"error"})}finally{X(!1)}},[t]),js=r.useCallback(async()=>{try{const s=await fetch("/api/admin/upload-config",{headers:{"X-Requested-With":"XMLHttpRequest"}});if(s.ok){const a=await s.json();Ze(a)}else Ze({maxZipSizeMB:200,maxZipSizeBytes:200*1024*1024,maxArchiveFiles:200,maxFileSize:10*1024*1024,allowedExtensions:[".jpg",".jpeg",".png",".webp",".gif"]})}catch{Ze({maxZipSizeMB:200,maxZipSizeBytes:200*1024*1024,maxArchiveFiles:200,maxFileSize:10*1024*1024,allowedExtensions:[".jpg",".jpeg",".png",".webp",".gif"]})}},[]);r.useEffect(()=>{if(!k||!S){P("/login");return}ve(),js()},[k,S,P,ve,js]),r.useEffect(()=>{te(new Set),us(new Set)},[d?.id]);const R=async s=>{try{const a=await fetch(`/api/admin/chapters?seriesId=${s}`);if(a.ok){const h=(await a.json()).map(x=>{const v={...x};if(x.coverImageUrl&&!x.coverImageUrl.startsWith("http")&&!x.coverImageUrl.startsWith("/api/")){const C=x.coverImageUrl.startsWith("chapters/")?x.coverImageUrl.substring(9):x.coverImageUrl;v.coverImageUrl=`/api/chapters/image/${C}`}return v});Ie(h)}}catch{t({title:"Error",description:"Failed to fetch chapters",variant:"error"})}},y=(s,a)=>{je(l=>({...l,[s]:a}))},he=()=>{je({title:"",description:"",author:"",artist:"",status:"ongoing",type:"manga",genres:[],coverImageUrl:"",rating:void 0,publishedYear:void 0,isAdult:"false",isFeatured:"false",isTrending:"false",isPopularToday:"false",isLatestUpdate:"false"}),z(null),ce(null),pe("url"),G.current&&(G.current.value="")},Ks=s=>{s.preventDefault(),We(!0)},Qs=s=>{s.preventDefault(),We(!1)},_s=s=>{s.preventDefault(),We(!1);const l=Array.from(s.dataTransfer.files).find(h=>h.name.toLowerCase().endsWith(".zip"));l?vs(l):t({title:"Error",description:"Please drop a ZIP file containing chapter images",variant:"error"})},vs=async s=>{if(!Q.trim()){t({title:"Error",description:"Please enter a chapter number first",variant:"error"});return}const a=parseFloat(Q.trim());if(isNaN(a)||a<=0){t({title:"Error",description:"Chapter number must be a valid positive number (e.g., 1, 1.5, 2)",variant:"error"});return}if(!s.name.toLowerCase().endsWith(".zip")){t({title:"Error",description:"Please upload a ZIP file containing chapter images",variant:"error"});return}if(!oe){t({title:"Error",description:"Upload configuration not loaded. Please try again.",variant:"error"});return}if(s.size>oe.maxZipSizeBytes){t({title:"Error",description:`Chapter ZIP file must be less than ${oe.maxZipSizeMB}MB`,variant:"error"});return}if(!d?.id){t({title:"Error",description:"Please save the series first before uploading chapters",variant:"error"});return}try{p(!0),ke(!0),U("Validating file and preparing upload..."),Be(0),qe("");const l=await fetch("/api/csrf-token",{credentials:"include"}),{csrfToken:h}=await l.json(),x=new FormData;x.append("zip",s),x.append("seriesId",d.id),x.append("chapterNumber",Q.trim()),Ue.trim()&&x.append("title",Ue.trim());const v=await new Promise((we,le)=>{const N=new XMLHttpRequest;N.upload.onloadstart=()=>{ke(!1),U("Uploading file to server...")},N.upload.onprogress=ue=>{if(ue.lengthComputable){const Me=Math.round(ue.loaded/ue.total*100);Be(Me),U(`Uploading... ${Me}%`)}},N.onload=()=>{ke(!1),we(new Response(N.responseText,{status:N.status,statusText:N.statusText,headers:N.getAllResponseHeaders().split(`\r
`).reduce((ue,Me)=>{const[Ps,Ds]=Me.split(": ");return Ps&&Ds&&(ue[Ps]=Ds),ue},{})}))},N.onerror=()=>le(new Error("Network error")),N.ontimeout=()=>le(new Error("Upload timeout")),N.open("POST","/api/admin/upload-chapter"),N.setRequestHeader("X-Requested-With","XMLHttpRequest"),N.setRequestHeader("x-csrf-token",h),N.send(x)}),C=await v.json();if(v.status===202)if(C.uploadId)qe(C.uploadId),Oe(C.uploadId),Se(!0),t({title:"Upload Started",description:`Chapter ${Q} upload started. Processing in background...`}),J.current&&(J.current.value=""),De(""),He("");else throw new Error("No upload ID returned from server");else if(v.ok)t({title:"Error",description:"Unexpected server response format. Please try again.",variant:"error"});else{const we=C.message||"Failed to upload chapter",le=C.requestId||C.uploadId?` (ID: ${C.requestId||C.uploadId})`:"";t({title:"Upload Failed",description:`${we}${le}`,variant:"error"})}}catch{const h=ds?` (Request ID: ${ds})`:"";t({title:"Upload Error",description:`Network error or server unavailable. Please check your connection and try again.${h}`,variant:"error"})}finally{p(!1),ke(!1),U(""),Be(0),qe("")}},ea=async s=>{const a=s.target.files?.[0];a&&vs(a)},sa=async s=>{if(L)try{const a=await _("PUT",`/api/admin/chapters/${L.chapter.id}`,{pages:s,requiresManualReorder:"false",naturalSortConfidence:"1.0"});t({title:"Success",description:`Chapter ${L.chapter.chapterNumber} page order updated successfully!`}),d?.id&&await R(d.id)}catch(a){t({title:"Error",description:a?.message||"Failed to update page order. Please try again.",variant:"error"})}finally{fs(null),gs(!1),d?.id&&await R(d.id)}},aa=async()=>{Se(!1),Oe(null),p(!1),U(""),d?.id&&await R(d.id),J.current&&(J.current.value=""),De(""),He(""),t({title:"Upload Complete",description:"Chapter has been uploaded successfully!"})},ra=s=>{Se(!1),Oe(null),p(!1),U(""),t({title:"Upload Failed",description:s,variant:"error"})},ta=async()=>{L&&d?.id&&await R(d.id),fs(null),gs(!1)},la=async s=>{try{await _("DELETE",`/api/admin/chapters/${s}`),t({title:"Success",description:"Chapter deleted successfully"}),d?.id&&await R(d.id),te(a=>{const l=new Set(a);return l.delete(s),l})}catch(a){t({title:"Error",description:a?.message||"Failed to delete chapter. Please try again.",variant:"error"})}},ws=s=>{Fe(s),Ee(!0)},ia=async()=>{if(q)try{await _("PATCH",`/api/admin/chapters/${q.id}`,{title:q.title||"",isPublished:q.isPublished}),t({title:"Success",description:"Chapter updated successfully"}),d?.id&&await R(d.id),Ee(!1),Fe(null)}catch(s){t({title:"Error",description:s?.message||"Failed to update chapter. Please try again.",variant:"error"})}},na=s=>{const a=new Set(j);a.has(s)?a.delete(s):a.add(s),te(a)},ca=()=>{j.size===D.length?te(new Set):te(new Set(D.map(s=>s.id)))},oa=s=>{us(a=>new Set([...Array.from(a),s]))},da=s=>{Ae(s),me(s.coverImageUrl)},ma=s=>{const a=s.target.files?.[0];if(a){if(a.size>5*1024*1024){t({title:"Error",description:"Cover image must be less than 5MB",variant:"error"});return}const l=new FileReader;l.onload=h=>{const x=h.target?.result;me(x)},l.readAsDataURL(a)}},ha=async()=>{if(!(!ze||!de))try{xs(!0);const s=await fetch("/api/csrf-token",{credentials:"include"}),{csrfToken:a}=await s.json(),l=new FormData;O.current?.files?.[0]?l.append("coverImage",O.current.files[0]):de.startsWith("http")&&l.append("coverImageUrl",de);const h=await fetch(`/api/admin/chapters/${ze.id}/cover`,{method:"PATCH",headers:{"X-Requested-With":"XMLHttpRequest","x-csrf-token":a},body:l,credentials:"include"});if(h.ok)t({title:"Success",description:"Chapter cover updated successfully"}),d?.id&&await R(d.id),Ae(null),me(null),O.current&&(O.current.value="");else{const x=await h.json();t({title:"Error",description:x.message||"Failed to update chapter cover",variant:"error"})}}catch(s){t({title:"Error",description:s?.message||"Failed to update chapter cover. Please try again.",variant:"error"})}finally{xs(!1)}},ua=async s=>{try{hs(!0),Os(s),Pe(!0);const a=await fetch(`/api/admin/chapters/${s.id}`);if(a.ok){const x=((await a.json()).pages||[]).map(v=>v.startsWith("http://")||v.startsWith("https://")||v.startsWith("/api/")?v:`/api/chapters/image/${v.startsWith("chapters/")?v.substring(9):v}`);Hs(x.slice(0,5))}else throw new Error("Failed to fetch chapter data")}catch{t({title:"Preview Error",description:"Failed to load chapter preview. Please try again.",variant:"error"}),Pe(!1)}finally{hs(!1)}},bs=async s=>{if(j.size!==0)try{const a=Array.from(j).map(l=>_("PATCH",`/api/admin/chapters/${l}`,{isPublished:s}));await Promise.all(a),t({title:"Success",description:`${j.size} chapters ${s?"published":"unpublished"} successfully`}),d?.id&&await R(d.id),te(new Set)}catch(a){t({title:"Error",description:a?.message||"Failed to update chapters. Please try again.",variant:"error"})}},pa=async()=>{if(j.size!==0)try{const s=Array.from(j).map(a=>_("DELETE",`/api/admin/chapters/${a}`));await Promise.all(s),t({title:"Success",description:`${j.size} chapters deleted successfully`}),d?.id&&await R(d.id),te(new Set),Te(!1)}catch(s){t({title:"Error",description:s?.message||"Failed to delete chapters. Please try again.",variant:"error"}),Te(!1)}},Ns=s=>{if(!s)return"Unknown";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},xa=(s,a)=>{je(l=>{const h=l.genres||[];return a===!0?{...l,genres:h.includes(s)?h:[...h,s]}:{...l,genres:h.filter(v=>v!==s)}})},ys=s=>{const a={...s};return Object.keys(a).forEach(l=>{const h=a[l];h===""&&!Array.isArray(h)&&(a[l]=void 0)}),a.genres||(a.genres=[]),a.isAdult=a.isAdult!==void 0?a.isAdult:"false",a.isFeatured=a.isFeatured!==void 0?a.isFeatured:"false",a.isTrending=a.isTrending!==void 0?a.isTrending:"false",a.isPopularToday=a.isPopularToday!==void 0?a.isPopularToday:"false",a.isLatestUpdate=a.isLatestUpdate!==void 0?a.isLatestUpdate:"false",a},ga=async()=>{if(!g.title?.trim()){t({title:"Error",description:"Title is required",variant:"error"});return}try{const s=ys(g),l=await(await _("POST","/api/admin/series",s)).json();t({title:"Success",description:"Series added successfully"}),await ve(),F(!1),he()}catch(s){t({title:"Error",description:s?.message||"Failed to add series. Please try again.",variant:"error"})}},Cs=async s=>{z(s),je({title:s.title,description:s.description||"",author:s.author||"",artist:s.artist||"",status:s.status,type:s.type,genres:s.genres||[],coverImageUrl:s.coverImageUrl||"",rating:s.rating,publishedYear:s.publishedYear,isAdult:s.isAdult||"false",isFeatured:s.isFeatured||"false",isTrending:s.isTrending||"false",isPopularToday:s.isPopularToday||"false",isLatestUpdate:s.isLatestUpdate||"false"}),s.coverImageUrl&&ce(s.coverImageUrl),await R(s.id)},ks=async()=>{if(!d?.id||!g.title?.trim()){t({title:"Error",description:"Title is required",variant:"error"});return}try{const s=ys(g),l=await(await _("PUT",`/api/admin/series/${d.id}`,s)).json();t({title:"Success",description:"Series updated successfully"}),await ve(),z(null),he()}catch(s){t({title:"Error",description:s?.message||"Failed to update series. Please try again.",variant:"error"})}},fa=async s=>{try{await _("DELETE",`/api/admin/series/${s}`),t({title:"Success",description:"Series deleted successfully"}),await ve(),I(null)}catch(a){t({title:"Error",description:a?.message||"Failed to delete series. Please try again.",variant:"error"})}},ja=async s=>{const a=s.target.files?.[0];if(!a)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(a.type.toLowerCase())){t({title:"Error",description:"Please upload a valid image file (JPEG, PNG, or WebP)",variant:"error"});return}if(a.size>5*1024*1024){t({title:"Error",description:"Image must be less than 5MB",variant:"error"});return}try{ne(!0);const h=await fetch("/api/csrf-token",{credentials:"include"}),{csrfToken:x}=await h.json(),v=new FormData;v.append("image",a);const C=await fetch("/api/admin/upload-cover",{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","x-csrf-token":x},body:v,credentials:"include"});if(!C.ok){const N=await C.json();throw new Error(N.message||"Upload failed")}const le=(await C.json()).url;je(N=>({...N,coverImageUrl:le})),ce(le),t({title:"Success",description:"Image uploaded successfully"})}catch(h){t({title:"Error",description:h?.message||"Failed to upload image. Please try again.",variant:"error"})}finally{ne(!1)}},va=s=>{const a=$s.find(l=>l.value===s);return e.jsx(ae,{variant:"secondary",className:a?.color,children:a?.label||s})},Ss=A.filter(s=>s.title.toLowerCase().includes(M.toLowerCase())||s.author?.toLowerCase().includes(M.toLowerCase())||s.type.toLowerCase().includes(M.toLowerCase())||s.genres?.some(a=>a.toLowerCase().includes(M.toLowerCase())));if(!k||!S)return null;const Ye=r.useMemo(()=>e.jsxs("div",{className:"grid gap-4 py-4 w-full min-w-0",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"title",children:"Title *"}),e.jsx(T,{id:"title",value:g.title||"",onChange:s=>y("title",s.target.value),className:"bg-background/50 w-full",autoComplete:"off"})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"author",children:"Author"}),e.jsx(T,{id:"author",value:g.author||"",onChange:s=>y("author",s.target.value),className:"bg-background/50 w-full",autoComplete:"off"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"type",children:"Type"}),e.jsxs(Ve,{value:g.type,onValueChange:s=>y("type",s),children:[e.jsx(Ge,{className:"bg-background/50 w-full",children:e.jsx(Je,{placeholder:"Select type"})}),e.jsx(Ke,{children:Za.map(s=>e.jsx(Le,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"status",children:"Status"}),e.jsxs(Ve,{value:g.status,onValueChange:s=>y("status",s),children:[e.jsx(Ge,{className:"bg-background/50 w-full",children:e.jsx(Je,{placeholder:"Select status"})}),e.jsx(Ke,{children:$s.map(s=>e.jsx(Le,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"description",children:"Description"}),e.jsx(Ua,{id:"description",value:g.description||"",onChange:s=>y("description",s.target.value),className:"bg-background/50 w-full resize-none",rows:3,autoComplete:"off"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"artist",children:"Artist"}),e.jsx(T,{id:"artist",value:g.artist||"",onChange:s=>y("artist",s.target.value),className:"bg-background/50 w-full"})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"publishedYear",children:"Published Year"}),e.jsx(T,{id:"publishedYear",type:"number",min:"1900",max:new Date().getFullYear()+5,value:g.publishedYear!=null?g.publishedYear.toString():"",onChange:s=>y("publishedYear",Gs(s.target.value)),className:"bg-background/50 w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"rating",children:"Rating (0-10)"}),e.jsx(T,{id:"rating",type:"number",min:"0",max:"10",step:"0.1",value:g.rating!=null?g.rating.toString():"",onChange:s=>y("rating",Js(s.target.value)),className:"bg-background/50 w-full"})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"coverUrl",children:"Cover Image URL"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(T,{id:"coverUrl",value:g.coverImageUrl||"",onChange:s=>y("coverImageUrl",s.target.value),className:"bg-background/50 w-full",placeholder:"https://example.com/cover.jpg",disabled:re==="file"}),e.jsx(n,{type:"button",variant:"outline",size:"sm",onClick:()=>pe(re==="url"?"file":"url"),className:"whitespace-nowrap flex-shrink-0",children:re==="url"?"Upload File":"Use URL"})]})]})]}),re==="file"&&e.jsx("div",{className:"space-y-4 border-t pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Cover Image Upload"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{ref:G,type:"file",accept:"image/*",onChange:ja,className:"hidden"}),e.jsx(n,{type:"button",variant:"outline",onClick:()=>G.current?.click(),disabled:f,className:"bg-background/50 hover:bg-background/70",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-primary border-t-transparent rounded-full mr-2"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Choose Image"]})}),V&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("img",{src:V,alt:"Preview",className:"h-16 w-12 object-cover rounded border max-w-full"}),e.jsx(n,{type:"button",variant:"ghost",size:"sm",onClick:()=>{y("coverImageUrl",""),ce(null),pe("url"),G.current&&(G.current.value="")},children:e.jsx(ee,{className:"w-4 h-4"})})]})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Genres"}),e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 max-h-32 overflow-y-scroll p-2 border rounded [&::-webkit-scrollbar]:hidden",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:Ya.map(s=>e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:s,className:"text-sm truncate cursor-pointer",children:s}),e.jsx(ie,{id:s,checked:g.genres?.includes(s)||!1,onCheckedChange:a=>xa(s,a),className:"flex-shrink-0"})]},s))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Content Settings"}),e.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[e.jsx(u,{htmlFor:"isAdult",className:"text-sm font-medium cursor-pointer",children:"Adult Content (18+)"}),e.jsx(ie,{id:"isAdult",checked:g.isAdult==="true",onCheckedChange:s=>{y("isAdult",s===!0?"true":"false")}})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{children:"Homepage Sections"}),e.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:"isFeatured",className:"text-sm font-medium truncate cursor-pointer",children:"Featured"}),e.jsx(ie,{id:"isFeatured",checked:g.isFeatured==="true",onCheckedChange:s=>{y("isFeatured",s===!0?"true":"false")},className:"flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:"isTrending",className:"text-sm font-medium truncate cursor-pointer",children:"Trending"}),e.jsx(ie,{id:"isTrending",checked:g.isTrending==="true",onCheckedChange:s=>{y("isTrending",s===!0?"true":"false")},className:"flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:"isPopularToday",className:"text-sm font-medium truncate cursor-pointer",children:"Popular Today"}),e.jsx(ie,{id:"isPopularToday",checked:g.isPopularToday==="true",onCheckedChange:s=>{y("isPopularToday",s===!0?"true":"false")},className:"flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:"isLatestUpdate",className:"text-sm font-medium truncate cursor-pointer",children:"Latest Updates"}),e.jsx(ie,{id:"isLatestUpdate",checked:g.isLatestUpdate==="true",onCheckedChange:s=>{y("isLatestUpdate",s===!0?"true":"false")},className:"flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 min-w-0",children:[e.jsx(u,{htmlFor:"isPinned",className:"text-sm font-medium truncate cursor-pointer",children:"Pinned"}),e.jsx(ie,{id:"isPinned",checked:g.isPinned==="true",onCheckedChange:s=>{y("isPinned",s===!0?"true":"false")},className:"flex-shrink-0"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Select which homepage sections this series should appear in. You can select multiple sections."})]}),d&&e.jsxs("div",{className:"space-y-4 border-t pt-6 mt-6",children:[e.jsxs("div",{children:[e.jsx(u,{className:"text-sm font-medium",children:"Chapter Management"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Upload and manage chapters for this series. Upload chapters as ZIP files containing images."})]}),e.jsx("div",{className:"rounded-lg bg-blue-50 dark:bg-blue-950/30 p-4 border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qa,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2 text-sm",children:"ðŸ“¸ Image Optimization Best Practices"}),e.jsxs("ul",{className:"text-xs text-blue-700 dark:text-blue-300 space-y-1.5",children:[e.jsxs("li",{children:["âœ“ ",e.jsx("strong",{children:"Format:"})," Use JPG/PNG. WebP support coming soon"]}),e.jsxs("li",{children:["âœ“ ",e.jsx("strong",{children:"Resolution:"})," 800-1200px width for web, 1600-2400px for high-quality"]}),e.jsxs("li",{children:["âœ“ ",e.jsx("strong",{children:"File size:"})," Keep images under 500KB each (compress before upload)"]}),e.jsxs("li",{children:["âœ“ ",e.jsx("strong",{children:"Naming:"})," Use sequential numbers (001.jpg, 002.jpg, etc.) for auto-sorting"]}),e.jsxs("li",{children:["âœ“ ",e.jsx("strong",{children:"Compression:"})," Use tools like TinyPNG or ImageOptim before uploading"]}),e.jsxs("li",{children:["âœ“ ",e.jsx("strong",{children:"Max pages:"})," Up to ",oe?.maxArchiveFiles||200," pages per chapter"]}),e.jsxs("li",{children:["âœ“ ",e.jsx("strong",{children:"Zip size:"})," Maximum ",oe?.maxZipSizeMB||100,"MB per upload"]})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"chapterNumber",className:"text-sm font-medium",children:"Chapter Number *"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{id:"chapterNumber",type:"text",placeholder:"e.g. 1, 1.5, 2",value:Q,onChange:s=>De(s.target.value),className:"bg-background/50 w-full pr-20",disabled:c}),D.length>0&&e.jsx(n,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1 h-8 px-2 text-xs text-muted-foreground hover:text-foreground whitespace-nowrap",onClick:()=>{const s=D.map(x=>parseFloat(x.chapterNumber)||0),a=Math.max(...s);let l;a%1!==0?l=Math.ceil(a):l=a+1;const h=l.toString();s.includes(l)?t({title:"Chapter Number Conflict",description:`Chapter ${h} already exists. Please use a different number.`,variant:"error"}):(De(h),t({title:"Chapter Number Suggested",description:`Set to Chapter ${h}`}))},disabled:c,title:"Suggest next chapter number based on existing chapters",children:Q?"Auto":`Next (${(()=>{const s=D.map(l=>parseFloat(l.chapterNumber)||0),a=Math.max(...s);return a%1!==0?Math.ceil(a):a+1})()})`})]})]}),e.jsxs("div",{className:"space-y-2 min-w-0",children:[e.jsx(u,{htmlFor:"chapterTitle",className:"text-sm font-medium",children:"Chapter Title (optional)"}),e.jsx(T,{id:"chapterTitle",type:"text",placeholder:"e.g. The Beginning",value:Ue,onChange:s=>He(s.target.value),className:"bg-background/50 w-full",disabled:c})]})]}),e.jsxs("div",{className:`relative border-2 border-dashed rounded-lg transition-all duration-200 overflow-hidden ${fe?"border-primary bg-primary/10 scale-[1.02]":c?"border-primary bg-primary/5":"border-border hover:border-primary/50 hover:bg-background/30"}`,onDragOver:Ks,onDragLeave:Qs,onDrop:_s,children:[e.jsx("input",{ref:J,type:"file",accept:".zip",onChange:ea,className:"hidden",disabled:c}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute bottom-0 left-0 w-full bg-gradient-to-t from-primary/25 to-primary/15 transition-all duration-1000 ease-out",style:{height:ge?"60%":`${xe}%`,animation:ge?"liquid-wave 3s ease-in-out infinite":"none"}}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full bg-gradient-to-t from-primary/35 to-primary/25 transition-all duration-1000 ease-out",style:{height:ge?"40%":`${Math.max(0,xe-15)}%`,animation:ge?"liquid-wave 3s ease-in-out infinite 0.5s":"none"}}),e.jsx("style",{children:`
                    @keyframes liquid-wave {
                      0%, 100% { transform: translateY(0px); }
                      50% { transform: translateY(-8px); }
                    }
                  `})]}),e.jsxs("div",{className:"relative z-10 p-8 text-center space-y-4",children:[e.jsx("div",{className:`mx-auto w-16 h-16 rounded-full flex items-center justify-center transition-colors duration-200 ${fe?"bg-primary/20 text-primary":c?"bg-muted text-muted-foreground":"bg-muted/50 text-muted-foreground hover:bg-primary/10 hover:text-primary"}`,children:c?e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full"}):e.jsx(ye,{className:"w-6 h-6"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:`font-medium ${fe||c?"text-primary":"text-foreground"}`,children:c?"Uploading Chapter...":fe?"Drop your ZIP file here":"Drag & Drop your ZIP file here"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c?ge?"Validating and processing...":`${w} (${xe}%)`:"or click to browse and select a ZIP file"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ZIP files should contain images named in order (001.jpg, 002.jpg, etc.) â€¢ Max ",oe?.maxZipSizeMB||200,"MB"]})]}),!c&&e.jsxs(n,{type:"button",variant:"outline",onClick:()=>J.current?.click(),disabled:!Q.trim(),className:"bg-background/50 hover:bg-background/70",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Browse Files"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs(u,{className:"text-sm font-medium",children:["Chapters (",D.length,")"]}),D.length>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:ca,className:"text-xs",children:j.size===D.length?e.jsxs(e.Fragment,{children:[e.jsx(As,{className:"w-3 h-3 mr-1"}),e.jsx("span",{className:"hidden xs:inline",children:"Deselect All"}),e.jsx("span",{className:"xs:hidden",children:"Deselect"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ms,{className:"w-3 h-3 mr-1"}),e.jsx("span",{className:"hidden xs:inline",children:"Select All"}),e.jsx("span",{className:"xs:hidden",children:"Select"})]})}),j.size>0&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>bs(!0),className:"text-xs",children:[e.jsx($e,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{className:"hidden sm:inline",children:["Publish (",j.size,")"]}),e.jsx("span",{className:"sm:hidden",children:"Publish"})]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>bs(!1),className:"text-xs",children:[e.jsx(Ra,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{className:"hidden sm:inline",children:["Unpublish (",j.size,")"]}),e.jsx("span",{className:"sm:hidden",children:"Unpublish"})]}),e.jsxs(n,{variant:"destructive",size:"sm",onClick:()=>Te(!0),className:"text-xs",children:[e.jsx(be,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{className:"hidden sm:inline",children:["Delete (",j.size,")"]}),e.jsx("span",{className:"sm:hidden",children:"Delete"})]})]})]})]}),D.length===0?e.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-border/50 rounded-lg",children:[e.jsx(Qe,{className:"w-8 h-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No chapters uploaded yet. Upload a ZIP file to add chapters."}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ZIP files should contain images named in order (001.jpg, 002.jpg, etc.)"})]}):e.jsx("div",{className:"space-y-2",children:D.sort((s,a)=>parseFloat(s.chapterNumber)-parseFloat(a.chapterNumber)).map((s,a)=>e.jsxs("div",{className:`group flex items-start sm:items-center bg-card/40 hover:bg-card/60 rounded-xl border border-border/30 p-2.5 sm:p-3 transition-all duration-200 hover:border-border/50 ${j.has(s.id)?"ring-2 ring-primary/40 bg-primary/8":""}`,children:[e.jsx("div",{className:"flex-shrink-0 mr-2 sm:mr-3",children:e.jsx(n,{variant:"ghost",size:"sm",className:"h-7 w-7 sm:h-8 sm:w-8 p-0 hover:bg-primary/10 rounded-lg",onClick:l=>{l.stopPropagation(),na(s.id)},children:j.has(s.id)?e.jsx(As,{className:"w-4 h-4 text-primary"}):e.jsx(Ms,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsx("div",{className:"flex-shrink-0 mr-3 sm:mr-4 relative",children:e.jsx("div",{className:"w-10 h-14 sm:w-12 sm:h-16 bg-muted/40 rounded-lg overflow-hidden group-hover:bg-muted/60 transition-all duration-200 shadow-sm",children:s.coverImageUrl&&!Xs.has(s.id)?e.jsx("img",{src:s.coverImageUrl,alt:`Chapter ${s.chapterNumber} cover`,className:"w-full h-full object-cover max-w-full",onError:()=>oa(s.id),loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Rs,{className:"w-5 h-5 text-muted-foreground/50"})})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0 space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("h3",{className:"font-semibold text-[11px] xs:text-sm sm:text-base leading-tight truncate",children:["Chapter ",s.chapterNumber]}),e.jsx("div",{className:`text-[9px] xs:text-xs sm:text-sm px-1.5 xs:px-2 py-0.5 rounded-full font-medium flex-shrink-0 ${s.isPublished==="true"?"bg-green-500 text-white":"bg-gray-500 text-white"}`,children:s.isPublished==="true"?"Published":"Draft"})]}),e.jsx("p",{className:"text-[10px] xs:text-xs sm:text-sm text-muted-foreground truncate leading-tight",title:s.title,children:s.title||"No title"}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 text-[10px] xs:text-xs sm:text-sm text-muted-foreground flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Qe,{className:"w-3 h-3 flex-shrink-0"}),e.jsxs("span",{className:"whitespace-nowrap",children:[s.totalPages," pages"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Fa,{className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{className:"truncate max-w-[120px] sm:max-w-none sm:whitespace-nowrap",children:Ns(s.createdAt)})]})]})]}),e.jsxs("div",{className:"flex gap-1 sm:gap-1.5 flex-shrink-0",children:[e.jsxs("div",{className:"flex gap-1 md:hidden",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>ws(s),className:"h-8 w-8 p-0 hover:bg-primary/10",title:"Edit chapter",children:e.jsx(Re,{className:"w-3 h-3"})}),e.jsx(n,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10 h-8 w-8 p-0",onClick:()=>m(s.id),title:"Delete chapter",children:e.jsx(be,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"hidden md:flex gap-1.5",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>ua(s),className:"h-9 w-9 lg:h-10 lg:w-10 p-0 hover:bg-primary/10",title:"Preview chapter pages",children:e.jsx($e,{className:"w-3.5 h-3.5 lg:w-4 lg:h-4"})}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>ws(s),className:"h-9 w-9 lg:h-10 lg:w-10 p-0 hover:bg-primary/10",title:"Edit chapter details",children:e.jsx(Re,{className:"w-3.5 h-3.5 lg:w-4 lg:h-4"})}),e.jsx(n,{variant:"outline",size:"sm",onClick:l=>{l.stopPropagation(),da(s)},className:"h-9 w-9 lg:h-10 lg:w-10 p-0 hover:bg-primary/10",title:"Change cover image",children:e.jsx(Ls,{className:"w-3.5 h-3.5 lg:w-4 lg:h-4"})}),e.jsx(n,{variant:"outline",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10 h-9 w-9 lg:h-10 lg:w-10 p-0",onClick:()=>m(s.id),title:"Delete chapter",children:e.jsx(be,{className:"w-3.5 h-3.5 lg:w-4 lg:h-4"})})]})]})]})})]},s.id))})]})]})]}),[g,d,D,c,w,f,V,re,Q,Ue,fe,j]),wa=e.jsx(H,{open:Zs,onOpenChange:Ee,children:e.jsxs(W,{className:"w-[95vw] sm:max-w-md",children:[e.jsxs(Z,{children:[e.jsxs(Y,{children:["Edit Chapter ",q?.chapterNumber]}),e.jsx(se,{children:"Update chapter metadata and publication status"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"editTitle",children:"Chapter Title (optional)"}),e.jsx(T,{id:"editTitle",value:q?.title||"",onChange:s=>Fe(a=>({...a,title:s.target.value})),placeholder:"Enter chapter title",className:"bg-background/50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Publication Status"}),e.jsxs(Ve,{value:q?.isPublished||"true",onValueChange:s=>Fe(a=>({...a,isPublished:s})),children:[e.jsx(Ge,{className:"bg-background/50",children:e.jsx(Je,{})}),e.jsxs(Ke,{children:[e.jsx(Le,{value:"true",children:"Published"}),e.jsx(Le,{value:"false",children:"Draft"})]})]})]}),e.jsxs("div",{className:"pt-2 space-y-1 text-xs text-muted-foreground",children:[e.jsxs("p",{children:["Pages: ",q?.totalPages]}),e.jsxs("p",{children:["Uploaded: ",Ns(q?.createdAt)]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(n,{variant:"outline",onClick:()=>Ee(!1),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(n,{onClick:ia,children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Update Chapter"]})]})]})}),ba=e.jsx(H,{open:!!ze,onOpenChange:()=>{Ae(null),me(null),O.current&&(O.current.value="")},children:e.jsxs(W,{className:"w-[95vw] sm:max-w-md",children:[e.jsxs(Z,{children:[e.jsx(Y,{children:"Edit Chapter Cover"}),e.jsxs(se,{children:["Update the cover image for Chapter ",ze?.chapterNumber]})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Cover Preview"}),e.jsx("div",{className:"relative aspect-[3/4] max-w-48 mx-auto rounded-lg overflow-hidden bg-muted/50 border",children:de?e.jsx("img",{src:de,alt:"Cover preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Rs,{className:"w-12 h-12 text-muted-foreground/50"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"chapterCoverFile",children:"Upload New Cover"}),e.jsx(T,{id:"chapterCoverFile",type:"file",ref:O,accept:"image/*",onChange:ma,className:"bg-background/50"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supported formats: JPG, PNG, WebP. Max size: 5MB"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"chapterCoverUrl",children:"Or Enter Image URL"}),e.jsx(T,{id:"chapterCoverUrl",type:"url",placeholder:"https://example.com/cover.jpg",value:de||"",onChange:s=>me(s.target.value),className:"bg-background/50"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(n,{variant:"outline",onClick:()=>{Ae(null),me(null),O.current&&(O.current.value="")},children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsx(n,{onClick:ha,disabled:ps,children:ps?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-current border-t-transparent"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Update Cover"]})})]})]})});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-background/95 p-2 sm:p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-0",children:[e.jsxs(n,{variant:"ghost",onClick:()=>P("/admin"),className:"w-fit text-muted-foreground hover:text-primary mb-4",children:[e.jsx(Es,{className:"w-4 h-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 sm:justify-between mb-6 sm:mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx(ya,{href:"/admin",children:e.jsxs(n,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-primary",children:[e.jsx(Es,{className:"w-4 h-4 mr-2"}),"Back to Admin Panel"]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Qe,{className:"w-8 h-8 text-primary"}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold bg-gradient-to-r from-primary via-accent to-purple-400 bg-clip-text text-transparent",children:"Content Management"})]})]}),e.jsxs(H,{open:o,onOpenChange:s=>{F(s),s||he()},children:[e.jsx(ss,{asChild:!0,children:e.jsxs(n,{className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90",children:[e.jsx($a,{className:"w-4 h-4 mr-2"}),"Add Series"]})}),e.jsxs(W,{className:"flex flex-col w-[95vw] sm:w-[70vw] max-w-none max-h-[90vh] sm:max-h-[85vh] overflow-hidden",children:[e.jsxs(Z,{className:"flex-shrink-0",children:[e.jsx(Y,{children:"Add New Series"}),e.jsx(se,{children:"Add a new manga/manhwa series to the collection."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden px-1 sm:px-2",children:Ye}),e.jsxs("div",{className:"flex justify-end space-x-2 flex-shrink-0 pt-4 border-t",children:[e.jsxs(n,{variant:"outline",onClick:()=>{F(!1),he()},children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(n,{onClick:ga,children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Add Series"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(_e,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(es,{className:"p-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ea,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(T,{placeholder:"Search series by title, author, type, or genre...",value:M,onChange:s=>b(s.target.value),className:"pl-10 bg-background/50"})]})})})}),e.jsx(_e,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(es,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold",children:A.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Series"})]})})})]}),e.jsxs(_e,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(Ta,{children:[e.jsx(za,{children:"All Series"}),e.jsx(Aa,{children:"Manage manga and manhwa series in the collection"})]}),e.jsx(es,{children:i?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading series..."})}):Ss.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:M?"No series found matching your search.":"No series found."})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:Ss.map(s=>e.jsxs("div",{className:"group relative bg-card/80 backdrop-blur-sm rounded-xl border border-border/40 overflow-hidden hover:shadow-xl hover:shadow-primary/10 transition-all duration-300 hover:border-primary/30 hover:scale-[1.02]",children:[e.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden bg-muted",children:[s.coverImageUrl?e.jsx("img",{src:s.coverImageUrl,alt:s.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-muted to-muted/60",children:e.jsx(Ls,{className:"w-8 h-8 text-muted-foreground/50"})}),e.jsx("div",{className:"absolute top-2 left-2",children:va(s.status)}),s.isAdult==="true"&&e.jsx(ae,{variant:"destructive",className:"absolute top-2 right-2 text-xs",children:"18+"}),s.rating&&e.jsxs("div",{className:"absolute bottom-2 right-2 flex items-center space-x-1 bg-black/70 backdrop-blur-sm rounded-md px-2 py-1",children:[e.jsx(Ma,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"text-white text-xs font-medium",children:s.rating})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute inset-x-2 bottom-2 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0 space-y-2",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(H,{children:[e.jsx(ss,{asChild:!0,children:e.jsxs(n,{size:"sm",variant:"secondary",className:"flex-1 bg-background/90 hover:bg-background text-xs min-h-[44px] h-auto px-3 py-2",onClick:()=>Cs(s),children:[e.jsx(Re,{className:"w-3 h-3 mr-1"}),"Edit"]})}),e.jsxs(W,{className:"flex flex-col w-[95vw] sm:w-[70vw] max-w-none max-h-[90vh] sm:max-h-[85vh] overflow-hidden",children:[e.jsxs(Z,{className:"flex-shrink-0",children:[e.jsx(Y,{children:"Edit Series"}),e.jsx(se,{children:"Update series information and metadata."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden px-1 sm:px-2",children:Ye}),e.jsxs("div",{className:"flex justify-end space-x-2 flex-shrink-0 pt-4 border-t",children:[e.jsxs(n,{variant:"outline",onClick:()=>{z(null),he()},children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(n,{onClick:ks,children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})]}),e.jsx(n,{size:"sm",variant:"destructive",className:"text-xs px-2",onClick:()=>I(s.id),children:e.jsx(be,{className:"w-3 h-3"})})]})})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 leading-tight",title:s.title,children:s.title}),s.author&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate mt-1",children:["by ",s.author]})]}),e.jsxs("div",{className:"flex md:hidden items-center space-x-2 ml-2 flex-shrink-0",children:[e.jsxs(H,{children:[e.jsx(ss,{asChild:!0,children:e.jsx(n,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 min-h-[44px]",onClick:()=>Cs(s),children:e.jsx(Re,{className:"w-4 h-4"})})}),e.jsxs(W,{className:"flex flex-col w-[95vw] sm:w-[70vw] max-w-none max-h-[90vh] sm:max-h-[85vh] overflow-hidden",children:[e.jsxs(Z,{className:"flex-shrink-0",children:[e.jsx(Y,{children:"Edit Series"}),e.jsx(se,{children:"Update series information and metadata."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden px-1 sm:px-2",children:Ye}),e.jsxs("div",{className:"flex justify-end space-x-2 flex-shrink-0 pt-4 border-t",children:[e.jsxs(n,{variant:"outline",onClick:()=>{z(null),he()},children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(n,{onClick:ks,children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Save Changes"]})]})]})]}),e.jsx(n,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 min-h-[44px] text-destructive hover:text-destructive",onClick:()=>I(s.id),children:e.jsx(be,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:e.jsx(ae,{variant:"outline",className:"text-xs",children:s.type})}),Array.isArray(s.genres)&&s.genres.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.genres.slice(0,2).map(a=>e.jsx(ae,{variant:"secondary",className:"text-xs px-1 py-0",children:a},a)),s.genres.length>2&&e.jsxs(ae,{variant:"secondary",className:"text-xs px-1 py-0",children:["+",s.genres.length-2]})]})]})]},s.id))})})]}),e.jsx(as,{open:!!E,onOpenChange:()=>I(null),children:e.jsxs(rs,{children:[e.jsxs(ts,{children:[e.jsx(ls,{children:"Delete Series"}),e.jsx(is,{children:"Are you sure you want to delete this series? This action cannot be undone and will permanently remove all series data, chapters, and images."})]}),e.jsxs(ns,{children:[e.jsx(cs,{children:"Cancel"}),e.jsx(os,{onClick:()=>E&&fa(E),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Series"})]})]})}),e.jsx(as,{open:!!B,onOpenChange:()=>m(null),children:e.jsxs(rs,{children:[e.jsxs(ts,{children:[e.jsx(ls,{children:"Delete Chapter"}),e.jsx(is,{children:"Are you sure you want to delete this chapter? This action cannot be undone and will permanently remove all chapter data and images."})]}),e.jsxs(ns,{children:[e.jsx(cs,{children:"Cancel"}),e.jsx(os,{onClick:()=>{B&&(la(B),m(null))},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Chapter"})]})]})}),wa,ba,e.jsx(as,{open:Ys,onOpenChange:Te,children:e.jsxs(rs,{children:[e.jsxs(ts,{children:[e.jsxs(ls,{children:["Delete ",j.size," Chapters"]}),e.jsxs(is,{children:["Are you sure you want to delete ",j.size," selected chapters? This action cannot be undone and will permanently remove all chapter data and images."]})]}),e.jsxs(ns,{children:[e.jsx(cs,{children:"Cancel"}),e.jsxs(os,{onClick:pa,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:["Delete ",j.size," Chapters"]})]})]})}),e.jsx(H,{open:qs,onOpenChange:Pe,children:e.jsxs(W,{className:"sm:max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs(Z,{className:"flex-shrink-0",children:[e.jsxs(Y,{children:["Preview: Chapter ",K?.chapterNumber,K?.title&&` - ${K.title}`]}),e.jsxs(se,{children:["Preview of the first few pages. ",K?.totalPages||0," total pages."]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:Ws?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"Loading preview..."})]}):ms.length>0?e.jsxs("div",{className:"space-y-4",children:[ms.map((s,a)=>e.jsxs("div",{className:"border rounded-lg overflow-hidden bg-muted/30",children:[e.jsxs("div",{className:"p-2 bg-muted/50 text-sm font-medium",children:["Page ",a+1]}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx("img",{src:s,alt:`Page ${a+1}`,className:"max-w-full max-h-96 object-contain rounded border",loading:"lazy",onError:l=>{l.target.src="/placeholder-image.png"}})})]},a)),K?.totalPages>5&&e.jsxs("div",{className:"text-center py-4 text-muted-foreground",children:["... and ",K.totalPages-5," more pages"]})]}):e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No preview available for this chapter."})}),e.jsxs("div",{className:"flex justify-end space-x-2 flex-shrink-0 pt-4 border-t",children:[e.jsxs(n,{variant:"outline",onClick:()=>Pe(!1),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Close"]}),K&&e.jsxs(n,{onClick:()=>{window.open(`/manga/${d?.id}/chapter/${K.chapterNumber}`,"_blank")},children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"View Full Chapter"]})]})]})}),L&&e.jsx(Ha,{isOpen:Vs,onClose:ta,onConfirm:sa,initialPages:L.pages,chapterNumber:L.chapter.chapterNumber,chapterTitle:L.chapter.title,naturalSortConfidence:L.naturalSortConfidence,requiresManualReorder:L.requiresManualReorder}),e.jsx(Wa,{open:Is,onOpenChange:Se,uploadId:Bs,onComplete:aa,onError:ra})]})})}export{or as default};
