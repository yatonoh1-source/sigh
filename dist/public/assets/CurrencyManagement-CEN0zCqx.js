import{j as e}from"./ui-vendor-_s0klCrL.js";import{u as _,b as x}from"./react-vendor-C7VPsBAG.js";import{u as G,a7 as J,_ as W,C as m,h as j,a1 as X,i as g,j as A,k as p,B as i,A as Z,an as ee,a9 as se,F as S,a0 as ae,r as n,I as c,s as D,v as k,w,x as O,y,aj as f,q as b}from"./index-BLJ_ytcB.js";import{T as re,a as ne,b as T,c as t,d as ce,e as l}from"./table-DVHEST2Z.js";import{D as U,a as F,b as E,c as I,d as B,e as q}from"./dialog-BPAt-TF-.js";import{P as ie}from"./plus-k2bBbm5g.js";import{P as te}from"./package-DcYjros-.js";import{D as le}from"./dollar-sign-xVsTkna1.js";import{S as de}from"./square-pen-CRfgceVq.js";import"./utils-vendor-DYGWDIxX.js";function fe(){const[,C]=_(),{isAdmin:H,isAuthenticated:L}=G(),{data:o,isLoading:R}=J(!1),{toast:d}=W(),[K,u]=x.useState(!1),[M,h]=x.useState(!1),[N,P]=x.useState(null),[a,r]=x.useState({name:"",currencyAmount:"",priceUSD:"",bonusPercentage:"0",isActive:"true",displayOrder:"0"}),Q=async()=>{try{await f("POST","/api/currency/packages",{...a,currencyAmount:parseInt(a.currencyAmount),bonusPercentage:parseInt(a.bonusPercentage),displayOrder:parseInt(a.displayOrder)}),b.invalidateQueries({queryKey:["/api/currency/packages"]}),u(!1),r({name:"",currencyAmount:"",priceUSD:"",bonusPercentage:"0",isActive:"true",displayOrder:"0"}),d({title:"Package Created",description:"Currency package has been created successfully."})}catch(s){d({title:"Error",description:s.message||"Failed to create package",variant:"error"})}},V=async()=>{if(N)try{await f("PATCH",`/api/currency/packages/${N.id}`,{...a,currencyAmount:parseInt(a.currencyAmount),bonusPercentage:parseInt(a.bonusPercentage),displayOrder:parseInt(a.displayOrder)}),b.invalidateQueries({queryKey:["/api/currency/packages"]}),h(!1),P(null),d({title:"Package Updated",description:"Currency package has been updated successfully."})}catch(s){d({title:"Error",description:s.message||"Failed to update package",variant:"error"})}},z=async s=>{if(confirm("Are you sure you want to delete this package?"))try{await f("DELETE",`/api/currency/packages/${s}`),b.invalidateQueries({queryKey:["/api/currency/packages"]}),d({title:"Package Deleted",description:"Currency package has been deleted successfully."})}catch(v){d({title:"Error",description:v.message||"Failed to delete package",variant:"error"})}},$=s=>{P(s),r({name:s.name,currencyAmount:s.currencyAmount.toString(),priceUSD:s.priceUSD,bonusPercentage:s.bonusPercentage.toString(),isActive:s.isActive,displayOrder:s.displayOrder.toString()}),h(!0)},Y=(s,v)=>s+Math.floor(s*v/100);return!L||!H?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-background/95 flex items-center justify-center p-4",children:e.jsxs(m,{className:"max-w-md w-full bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(j,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(X,{className:"w-8 h-8 text-primary"})}),e.jsx(g,{className:"text-2xl",children:"Admin Access Required"}),e.jsx(A,{className:"mt-2",children:"You need admin privileges to access currency management"})]}),e.jsx(p,{children:e.jsx(i,{onClick:()=>C("/"),className:"w-full",children:"Return to Home"})})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(i,{variant:"ghost",onClick:()=>C("/admin"),className:"w-fit text-muted-foreground hover:text-primary mb-4",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Currency Packages"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage shop packages for currency purchases"})]}),e.jsxs(i,{onClick:()=>u(!0),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Create Package"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(m,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Total Packages"}),e.jsx(te,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(p,{children:e.jsx("div",{className:"text-2xl font-bold",children:o?.length||0})})]}),e.jsxs(m,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Active Packages"}),e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(p,{children:e.jsx("div",{className:"text-2xl font-bold",children:o?.filter(s=>s.isActive==="true").length||0})})]})]}),e.jsxs(m,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Currency Packages"}),e.jsx(A,{children:"Configure packages available in the shop"})]}),e.jsx(p,{children:R?e.jsx("div",{children:"Loading..."}):o&&o.length>0?e.jsxs(re,{children:[e.jsx(ne,{children:e.jsxs(T,{children:[e.jsx(t,{children:"Name"}),e.jsx(t,{children:"Coins"}),e.jsx(t,{children:"Price"}),e.jsx(t,{children:"Bonus"}),e.jsx(t,{children:"Total Coins"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Order"}),e.jsx(t,{className:"text-right",children:"Actions"})]})}),e.jsx(ce,{children:o.map(s=>e.jsxs(T,{children:[e.jsx(l,{className:"font-medium",children:s.name}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-4 h-4 text-primary"}),s.currencyAmount]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-4 h-4 text-green-500"}),s.priceUSD]})}),e.jsx(l,{children:s.bonusPercentage>0?e.jsxs(S,{variant:"secondary",children:["+",s.bonusPercentage,"%"]}):e.jsx("span",{className:"text-muted-foreground",children:"No bonus"})}),e.jsx(l,{className:"font-semibold",children:Y(s.currencyAmount,s.bonusPercentage)}),e.jsx(l,{children:e.jsx(S,{variant:s.isActive==="true"?"default":"secondary",children:s.isActive==="true"?"Active":"Inactive"})}),e.jsx(l,{children:s.displayOrder}),e.jsx(l,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>$(s),children:e.jsx(de,{className:"w-4 h-4"})}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>z(s.id),children:e.jsx(ae,{className:"w-4 h-4"})})]})})]},s.id))})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No currency packages found. Create one to get started."})})]}),e.jsx(U,{open:K,onOpenChange:u,children:e.jsxs(F,{className:"max-w-md",children:[e.jsxs(E,{children:[e.jsx(I,{children:"Create Currency Package"}),e.jsx(B,{children:"Add a new package to the shop"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"name",children:"Package Name"}),e.jsx(c,{id:"name",value:a.name,onChange:s=>r({...a,name:s.target.value}),placeholder:"Starter Pack"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"currencyAmount",children:"Base Coins"}),e.jsx(c,{id:"currencyAmount",type:"number",value:a.currencyAmount,onChange:s=>r({...a,currencyAmount:s.target.value}),placeholder:"100"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"bonusPercentage",children:"Bonus %"}),e.jsx(c,{id:"bonusPercentage",type:"number",value:a.bonusPercentage,onChange:s=>r({...a,bonusPercentage:s.target.value}),placeholder:"0"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"priceUSD",children:"Price (USD)"}),e.jsx(c,{id:"priceUSD",value:a.priceUSD,onChange:s=>r({...a,priceUSD:s.target.value}),placeholder:"4.99"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"displayOrder",children:"Display Order"}),e.jsx(c,{id:"displayOrder",type:"number",value:a.displayOrder,onChange:s=>r({...a,displayOrder:s.target.value}),placeholder:"0"})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"isActive",children:"Status"}),e.jsxs(D,{value:a.isActive,onValueChange:s=>r({...a,isActive:s}),children:[e.jsx(k,{children:e.jsx(w,{})}),e.jsxs(O,{children:[e.jsx(y,{value:"true",children:"Active"}),e.jsx(y,{value:"false",children:"Inactive"})]})]})]})]}),e.jsxs(q,{children:[e.jsx(i,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(i,{onClick:Q,children:"Create Package"})]})]})}),e.jsx(U,{open:M,onOpenChange:h,children:e.jsxs(F,{className:"max-w-md",children:[e.jsxs(E,{children:[e.jsx(I,{children:"Edit Currency Package"}),e.jsx(B,{children:"Update package details"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-name",children:"Package Name"}),e.jsx(c,{id:"edit-name",value:a.name,onChange:s=>r({...a,name:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-currencyAmount",children:"Base Coins"}),e.jsx(c,{id:"edit-currencyAmount",type:"number",value:a.currencyAmount,onChange:s=>r({...a,currencyAmount:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-bonusPercentage",children:"Bonus %"}),e.jsx(c,{id:"edit-bonusPercentage",type:"number",value:a.bonusPercentage,onChange:s=>r({...a,bonusPercentage:s.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-priceUSD",children:"Price (USD)"}),e.jsx(c,{id:"edit-priceUSD",value:a.priceUSD,onChange:s=>r({...a,priceUSD:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-displayOrder",children:"Display Order"}),e.jsx(c,{id:"edit-displayOrder",type:"number",value:a.displayOrder,onChange:s=>r({...a,displayOrder:s.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-isActive",children:"Status"}),e.jsxs(D,{value:a.isActive,onValueChange:s=>r({...a,isActive:s}),children:[e.jsx(k,{children:e.jsx(w,{})}),e.jsxs(O,{children:[e.jsx(y,{value:"true",children:"Active"}),e.jsx(y,{value:"false",children:"Inactive"})]})]})]})]}),e.jsxs(q,{children:[e.jsx(i,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(i,{onClick:V,children:"Update Package"})]})]})})]})}export{fe as default};
