import{j as e}from"./ui-vendor-_s0klCrL.js";import{b as p,u as Fs}from"./react-vendor-C7VPsBAG.js";import{c as ie,az as ae,B as g,ap as Oe,L as ls,o as is,e as Ps,C as T,h as R,i as B,F as k,k as E,aA as Ie,an as Te,s as J,v as z,w as _,x as K,y as h,aa as ns,ab as cs,ac as re,ad as le,j as Q,_ as ds,ax as os,b as Ge,d as X,r as i,I as v,p as Z,a0 as Re,u as Ls,f as ee,a1 as Us,A as Os,Y as ze,aw as Is,am as Rs,ay as M,ao as ge,ak as Bs,a5 as ye}from"./index-BLJ_ytcB.js";import{D as we,a as Ce,b as ke,c as De,d as Se,e as Ae}from"./dialog-BPAt-TF-.js";import{A as _e,a as Ke,b as Qe,c as He,d as We,e as Ye,f as Xe,g as Ze}from"./alert-dialog-CQ2ww59i.js";import{I as ms}from"./image-BxQwejDH.js";import{E as fe}from"./eye-CaJoh2v9.js";import{M as oe}from"./monitor-C8b6Kadu.js";import{L as Vs,B as qs,D as Gs,C as $s,a as Ms,b as Js,c as zs,d as _s,e as Ks,A as Qs,p as Hs,f as Ws,g as Ys,i as Xs}from"./chart-vendor-BWHaG5wj.js";import{T as xs}from"./trending-down-BwsJp3ld.js";import{C as hs}from"./chart-column-CWfcpHvH.js";import{P as Be}from"./plus-k2bBbm5g.js";import{A as Zs}from"./AdIntensityControl-BeITXsYb.js";import{A as es}from"./activity-Blw82mLV.js";import{S as et}from"./square-check-big-CO7qm0JX.js";import{D as ss}from"./download-BAdLORKC.js";import{G as st}from"./globe-DHpg7DRg.js";import{D as Le}from"./dollar-sign-xVsTkna1.js";import{S as tt}from"./square-pen-CRfgceVq.js";import{F as ts}from"./file-text-BFdtmCm2.js";import"./utils-vendor-DYGWDIxX.js";import"./shield-off-j9I-w8cD.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=ie("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=ie("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=ie("MousePointerClick",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=ie("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=ie("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=ie("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=ie("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=ie("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);function qe({value:o,onChange:N,onFileChange:w,disabled:c=!1,className:b,accept:P="image/jpeg,image/jpg,image/png,image/webp,image/gif",maxSize:j=10,uploadEndpoint:U="/api/admin/upload-ad-image"}){const[m,F]=p.useState(!1),[V,O]=p.useState(o),[$,G]=p.useState(!1),[H,y]=p.useState(null),D=p.useRef(null);p.useEffect(()=>{O(o)},[o]);const ne=u=>{u.preventDefault(),c||F(!0)},W=u=>{u.preventDefault(),F(!1)},se=u=>{const t=P.split(",").map(n=>n.trim());if(!t.includes(u.type))return`Invalid file type. Accepted: ${t.join(", ")}`;const l=j*1024*1024;return u.size>l?`File size must be less than ${j}MB`:null},d=async u=>{G(!0),y(null);try{const t=new FormData;t.append("image",u);const l=await Ps(U,t);if(!l.ok){const Y=await l.json();throw new Error(Y.message||"Upload failed")}const n=await l.json();N(n.url),O(n.url),w&&w(u)}catch(t){const l=t instanceof Error?t.message:"Failed to upload image";y(l)}finally{G(!1)}},f=async u=>{if(u.preventDefault(),F(!1),c)return;const t=u.dataTransfer.files;if(t.length===0)return;const l=t[0],n=se(l);if(n){y(n);return}await d(l)},C=async u=>{const t=u.target.files;if(!t||t.length===0)return;const l=t[0],n=se(l);if(n){y(n);return}await d(l)},L=()=>{O(void 0),N(""),w&&w(null),D.current&&(D.current.value=""),y(null)};return e.jsxs("div",{className:ae("space-y-2",b),children:[V?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:V,alt:"Upload preview",className:"w-full h-48 object-cover rounded-lg border-2 border-border"}),e.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center",children:e.jsxs(g,{type:"button",variant:"destructive",size:"sm",onClick:L,disabled:c||$,children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),"Remove"]})})]}):e.jsxs("div",{onDragOver:ne,onDragLeave:W,onDrop:f,className:ae("border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer",m&&!c?"border-primary bg-primary/10":"border-border hover:border-primary/50",c&&"opacity-50 cursor-not-allowed"),onClick:()=>!c&&!$&&D.current?.click(),children:[e.jsx("input",{ref:D,type:"file",accept:P,onChange:C,className:"hidden",disabled:c||$}),$?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(ls,{className:"w-12 h-12 text-primary animate-spin"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uploading..."})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[m?e.jsx(is,{className:"w-12 h-12 text-primary"}):e.jsx(ms,{className:"w-12 h-12 text-muted-foreground"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:m?"Drop image here":"Click to upload or drag and drop"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["PNG, JPG, WebP, GIF (max ",j,"MB)"]})]})]})]}),H&&e.jsx("p",{className:"text-sm text-destructive",children:H})]})}function rs({title:o,description:N,imageUrl:w,linkUrl:c,type:b,page:P,location:j,className:U}){const[m,F]=p.useState("desktop"),V={mobile:"max-w-[375px]",tablet:"max-w-[768px]",desktop:"max-w-full"},O=()=>{switch(b){case"banner":return e.jsx("div",{className:"w-full bg-gradient-to-r from-purple-900/20 via-pink-900/20 to-purple-900/20 rounded-lg overflow-hidden border-2 border-purple-500/30",children:w?e.jsxs("div",{className:"relative group cursor-pointer",children:[e.jsx("img",{src:w,alt:o,className:"w-full h-32 md:h-40 object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("div",{className:"absolute bottom-3 left-3 right-3",children:[e.jsx("h4",{className:"font-bold text-white text-sm md:text-base truncate",children:o||"Ad Title"}),N&&e.jsx("p",{className:"text-xs text-white/80 truncate",children:N})]})})]}):e.jsx("div",{className:"h-32 md:h-40 flex items-center justify-center bg-muted/50",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"Banner Ad Preview"})})});case"sidebar":return e.jsxs("div",{className:"w-full max-w-xs bg-gradient-to-br from-purple-900/10 to-pink-900/10 rounded-lg overflow-hidden border border-purple-500/30",children:[w?e.jsx("img",{src:w,alt:o,className:"w-full h-64 object-cover"}):e.jsx("div",{className:"h-64 flex items-center justify-center bg-muted/50",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"Sidebar Ad"})}),e.jsxs("div",{className:"p-3 space-y-1",children:[e.jsx("h4",{className:"font-semibold text-sm text-foreground truncate",children:o||"Ad Title"}),N&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:N}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-purple-400 hover:text-purple-300 transition-colors",children:[e.jsx(Ie,{className:"w-3 h-3"}),e.jsx("span",{children:"Learn More"})]})]})]});case"popup":return e.jsx("div",{className:"relative max-w-md mx-auto",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-950 to-pink-950 rounded-xl overflow-hidden border-2 border-purple-500/50 shadow-2xl shadow-purple-500/20",children:[w?e.jsx("img",{src:w,alt:o,className:"w-full h-48 object-cover"}):e.jsx("div",{className:"h-48 flex items-center justify-center bg-muted/50",children:e.jsx("p",{className:"text-muted-foreground text-sm",children:"Popup Ad"})}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("h3",{className:"font-bold text-lg text-white",children:o||"Ad Title"}),N&&e.jsx("p",{className:"text-sm text-gray-300",children:N}),e.jsx("button",{className:"w-full px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white rounded-lg font-medium transition-all transform hover:scale-105",children:"Learn More"})]})]})});case"inline":return e.jsx("div",{className:"w-full bg-gradient-to-r from-purple-900/5 via-transparent to-pink-900/5 rounded-lg overflow-hidden border border-purple-500/20",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 p-3",children:[w?e.jsx("img",{src:w,alt:o,className:"w-full md:w-32 h-24 md:h-20 object-cover rounded"}):e.jsx("div",{className:"w-full md:w-32 h-24 md:h-20 flex items-center justify-center bg-muted/50 rounded",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"Inline"})}),e.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[e.jsx(k,{className:"w-fit mb-1 bg-purple-600/20 text-purple-300 border-purple-500/30",children:"Sponsored"}),e.jsx("h4",{className:"font-semibold text-sm text-foreground",children:o||"Ad Title"}),N&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:N})]})]})});default:return e.jsx("div",{className:"w-full h-32 bg-muted/50 rounded-lg flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Select an ad type to preview"})})}};return e.jsxs(T,{className:ae("bg-card/50 backdrop-blur border-purple-500/20",U),children:[e.jsxs(R,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-purple-400"}),e.jsx(B,{className:"text-base",children:"Live Preview"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{variant:"outline",className:"text-xs border-purple-500/30",children:b||"No Type"}),e.jsxs(k,{variant:"outline",className:"text-xs border-pink-500/30",children:[P||"No Page"," / ",j||"No Location"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t border-border/50",children:[e.jsx("span",{className:"text-xs text-muted-foreground mr-2",children:"Device:"}),e.jsxs(g,{variant:m==="mobile"?"default":"outline",size:"sm",onClick:()=>F("mobile"),className:ae("h-8 gap-1.5",m==="mobile"&&"bg-purple-600 hover:bg-purple-700"),children:[e.jsx(us,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs",children:"Mobile"})]}),e.jsxs(g,{variant:m==="tablet"?"default":"outline",size:"sm",onClick:()=>F("tablet"),className:ae("h-8 gap-1.5",m==="tablet"&&"bg-purple-600 hover:bg-purple-700"),children:[e.jsx(it,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs",children:"Tablet"})]}),e.jsxs(g,{variant:m==="desktop"?"default":"outline",size:"sm",onClick:()=>F("desktop"),className:ae("h-8 gap-1.5",m==="desktop"&&"bg-purple-600 hover:bg-purple-700"),children:[e.jsx(oe,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs",children:"Desktop"})]}),e.jsxs(k,{variant:"secondary",className:"ml-auto text-xs",children:[m==="mobile"&&"375px",m==="tablet"&&"768px",m==="desktop"&&"Full Width"]})]})]}),e.jsxs(E,{className:"space-y-3",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:ae("w-full transition-all duration-300 ease-in-out",V[m]),children:e.jsx("div",{className:"p-4 bg-background/50 rounded-lg border border-border",children:e.jsx("div",{className:ae("transition-all duration-300",m==="mobile"&&"scale-95",m==="tablet"&&"scale-98"),children:O()})})})}),!w&&e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Upload an image to see the full preview"}),c&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Ie,{className:"w-3 h-3"}),e.jsxs("span",{className:"truncate",children:["Links to: ",c]})]})]})]})}$s.register(Ms,Js,zs,_s,Ks,Qs,Hs,Ws,Ys,Xs);function nt({ads:o}){const[N,w]=p.useState("7d"),[c,b]=p.useState("all"),[P,j]=p.useState(!0),[U,m]=p.useState(null),[F,V]=p.useState({totalImpressions:0,totalClicks:0,averageCTR:0}),[O,$]=p.useState([]),[G,H]=p.useState([]),y=n=>{const Y=new Date().toISOString().split("T")[0],I=new Date;switch(n){case"7d":I.setDate(I.getDate()-7);break;case"30d":I.setDate(I.getDate()-30);break;case"90d":I.setDate(I.getDate()-90);break;default:I.setDate(I.getDate()-7)}return{startDate:I.toISOString().split("T")[0],endDate:Y}},D=async()=>{j(!0),m(null);try{const{startDate:n,endDate:Y}=y(N),I=new URLSearchParams({startDate:n,endDate:Y}),[de,me,ve]=await Promise.all([fetch(`/api/ads/analytics/overview?${I}`),fetch(`/api/ads/analytics/performance-history?${I}`),fetch(`/api/ads/analytics/top-performers?${I}&limit=5`)]);if(!de.ok||!me.ok||!ve.ok)throw new Error("Failed to fetch analytics data");const[xe,Ne,be]=await Promise.all([de.json(),me.json(),ve.json()]);V(xe),$(Ne),H(be)}catch(n){m(n instanceof Error?n.message:"Failed to load analytics")}finally{j(!1)}};p.useEffect(()=>{D()},[N]);const ne=n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"}),W=O.map(n=>ne(n.date)),se=O.map(n=>n.impressions),d=O.map(n=>n.clicks),f=O.map(n=>n.ctr),C={labels:W,datasets:[{label:"CTR (%)",data:f,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.1)",fill:!0,tension:.4}]},L={labels:W,datasets:[{label:"Impressions",data:se,borderColor:"rgb(236, 72, 153)",backgroundColor:"rgba(236, 72, 153, 0.5)",yAxisID:"y"},{label:"Clicks",data:d,borderColor:"rgb(168, 85, 247)",backgroundColor:"rgba(168, 85, 247, 0.5)",yAxisID:"y1"}]},u={labels:["Banner","Sidebar","Popup","Inline"],datasets:[{data:[o.filter(n=>n.type==="banner").length,o.filter(n=>n.type==="sidebar").length,o.filter(n=>n.type==="popup").length,o.filter(n=>n.type==="inline").length],backgroundColor:["rgba(168, 85, 247, 0.8)","rgba(236, 72, 153, 0.8)","rgba(139, 92, 246, 0.8)","rgba(244, 114, 182, 0.8)"],borderColor:["rgb(168, 85, 247)","rgb(236, 72, 153)","rgb(139, 92, 246)","rgb(244, 114, 182)"],borderWidth:2}]},t={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgb(156, 163, 175)",font:{size:12}}},tooltip:{backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"rgb(243, 244, 246)",bodyColor:"rgb(209, 213, 219)",borderColor:"rgb(168, 85, 247)",borderWidth:1}},scales:{x:{ticks:{color:"rgb(156, 163, 175)",font:{size:11}},grid:{color:"rgba(75, 85, 99, 0.2)"}},y:{ticks:{color:"rgb(156, 163, 175)",font:{size:11}},grid:{color:"rgba(75, 85, 99, 0.2)"}}}},l={...t,scales:{...t.scales,y1:{type:"linear",position:"right",ticks:{color:"rgb(156, 163, 175)",font:{size:11}},grid:{drawOnChartArea:!1}}}};return P?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(ls,{className:"w-8 h-8 animate-spin text-purple-400"})}):U?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-400 mb-2",children:"Error loading analytics"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:U}),e.jsx("button",{onClick:D,className:"mt-4 px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-md text-sm",children:"Retry"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(T,{className:"bg-gradient-to-br from-purple-900/20 to-purple-800/10 border-purple-500/30",children:[e.jsx(R,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Total Impressions"}),e.jsx(fe,{className:"w-4 h-4 text-purple-400"})]})}),e.jsxs(E,{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:F.totalImpressions.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Across all ads"})]})]}),e.jsxs(T,{className:"bg-gradient-to-br from-pink-900/20 to-pink-800/10 border-pink-500/30",children:[e.jsx(R,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Total Clicks"}),e.jsx(Ee,{className:"w-4 h-4 text-pink-400"})]})}),e.jsxs(E,{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:F.totalClicks.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Engagement actions"})]})]}),e.jsxs(T,{className:"bg-gradient-to-br from-purple-900/20 to-pink-900/20 border-purple-500/30",children:[e.jsx(R,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Average CTR"}),e.jsx(Ve,{className:"w-4 h-4 text-purple-400"})]})}),e.jsxs(E,{children:[e.jsxs("div",{className:"text-2xl font-bold text-foreground",children:[F.averageCTR.toFixed(2),"%"]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[F.averageCTR>2?e.jsx(Te,{className:"w-3 h-3 text-green-400"}):e.jsx(xs,{className:"w-3 h-3 text-red-400"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Click-through rate"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(J,{value:N,onValueChange:w,children:[e.jsx(z,{className:"w-full sm:w-[180px]",children:e.jsx(_,{})}),e.jsxs(K,{children:[e.jsx(h,{value:"7d",children:"Last 7 Days"}),e.jsx(h,{value:"30d",children:"Last 30 Days"}),e.jsx(h,{value:"90d",children:"Last 90 Days"})]})]}),e.jsxs(J,{value:c,onValueChange:b,children:[e.jsx(z,{className:"w-full sm:w-[250px]",children:e.jsx(_,{})}),e.jsxs(K,{children:[e.jsx(h,{value:"all",children:"All Ads"}),o.map(n=>e.jsx(h,{value:n.id,children:n.title},n.id))]})]})]}),e.jsxs(ns,{defaultValue:"ctr",className:"w-full",children:[e.jsxs(cs,{className:"grid w-full grid-cols-4",children:[e.jsx(re,{value:"ctr",children:"CTR Trend"}),e.jsx(re,{value:"performance",children:"Performance"}),e.jsx(re,{value:"distribution",children:"Distribution"}),e.jsx(re,{value:"top",children:"Top Ads"})]}),e.jsx(le,{value:"ctr",className:"mt-4",children:e.jsxs(T,{children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-5 h-5 text-purple-400"}),"Click-Through Rate Trend"]}),e.jsx(Q,{children:"Track CTR performance over time"})]}),e.jsx(E,{children:e.jsx("div",{className:"h-[300px]",children:O.length>0?e.jsx(Vs,{data:C,options:t}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No performance data available for the selected range"})})})]})}),e.jsx(le,{value:"performance",className:"mt-4",children:e.jsxs(T,{children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"w-5 h-5 text-pink-400"}),"Impressions vs Clicks"]}),e.jsx(Q,{children:"Compare ad visibility and engagement"})]}),e.jsx(E,{children:e.jsx("div",{className:"h-[300px]",children:O.length>0?e.jsx(qs,{data:L,options:l}):e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No performance data available for the selected range"})})})]})}),e.jsx(le,{value:"distribution",className:"mt-4",children:e.jsxs(T,{children:[e.jsxs(R,{children:[e.jsx(B,{children:"Ad Type Distribution"}),e.jsx(Q,{children:"Breakdown of ads by type"})]}),e.jsx(E,{children:e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:o.length>0?e.jsx(Gs,{data:u,options:{...t,scales:void 0}}):e.jsx("div",{className:"text-muted-foreground",children:"No ads available"})})})]})}),e.jsx(le,{value:"top",className:"mt-4",children:e.jsxs(T,{children:[e.jsxs(R,{children:[e.jsx(B,{children:"Top Performing Ads"}),e.jsx(Q,{children:"Ranked by click-through rate"})]}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-3",children:[G.map((n,Y)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{variant:"outline",className:"w-8 h-8 flex items-center justify-center",children:Y+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:n.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.type," â€¢ ",n.placement]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-lg text-purple-400",children:[n.ctr.toFixed(2),"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.clicks," / ",n.impressions]})]})]},n.id)),G.length===0&&e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No ad performance data available"})]})})]})})]})]})}async function ct(){const o=await fetch("/api/admin/ads",{credentials:"include"});if(!o.ok)throw new Error("Failed to fetch advertisements");return o.json()}async function dt(o){const N=await fetch(`/api/ads/analytics/variant-comparison/${o}`,{credentials:"include"});if(!N.ok)throw new Error("Failed to fetch variant comparison");return N.json()}async function ot(){const o=await fetch("/api/csrf-token",{credentials:"include"});if(!o.ok)throw new Error("Failed to fetch CSRF token");return(await o.json()).csrfToken}function mt(){const{toast:o}=ds(),N=os(),[w,c]=p.useState(!1),[b,P]=p.useState(""),[j,U]=p.useState([{variantName:"A",title:"",imageUrl:"",linkUrl:"",type:"banner",placement:"homepage",displayOrder:0},{variantName:"B",title:"",imageUrl:"",linkUrl:"",type:"banner",placement:"homepage",displayOrder:0}]),[m,F]=p.useState(new Set),{data:V,isLoading:O}=Ge({queryKey:["admin-ads"],queryFn:ct}),$=V?Array.from(new Set(V.filter(d=>d.variantGroup).map(d=>d.variantGroup))):[],G=X({mutationFn:async d=>{const f=await ot(),C={variantGroup:d.variantGroup,variants:d.variants.map(u=>({...u,isActive:"true",displayOrder:Number(u.displayOrder)||0}))},L=await fetch("/api/ads/variants",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":f},credentials:"include",body:JSON.stringify(C)});if(!L.ok){const u=await L.json();throw new Error(u.message||"Failed to create variant group")}return L.json()},onSuccess:()=>{N.invalidateQueries({queryKey:["admin-ads"]}),o({title:"Success",description:"Variant group created successfully"}),c(!1),ne()},onError:d=>{o({title:"Error",description:d.message,variant:"error"})}}),H=()=>{const d=String.fromCharCode(65+j.length);U([...j,{variantName:d,title:"",imageUrl:"",linkUrl:"",type:j[0]?.type||"banner",placement:j[0]?.placement||"homepage",displayOrder:j[0]?.displayOrder||0}])},y=d=>{j.length>2&&U(j.filter((f,C)=>C!==d))},D=(d,f,C)=>{const L=[...j];L[d]={...L[d],[f]:C},U(L)},ne=()=>{P(""),U([{variantName:"A",title:"",imageUrl:"",linkUrl:"",type:"banner",placement:"homepage",displayOrder:0},{variantName:"B",title:"",imageUrl:"",linkUrl:"",type:"banner",placement:"homepage",displayOrder:0}])},W=()=>{if(!b.trim()){o({title:"Error",description:"Please enter a variant group name",variant:"error"});return}if(j.find(f=>!f.title||!f.imageUrl||!f.linkUrl)){o({title:"Error",description:"All variants must have title, image, and link",variant:"error"});return}G.mutate({variantGroup:b,variants:j})},se=d=>{const f=new Set(m);f.has(d)?f.delete(d):f.add(d),F(f)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(T,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-2xl font-bold",children:"A/B Testing"}),e.jsx(Q,{className:"mt-2",children:"Create and manage ad variant groups for A/B testing"})]}),e.jsxs(g,{onClick:()=>c(!0),className:"gap-2",children:[e.jsx(Be,{className:"w-4 h-4"}),"Create Variant Group"]})]})}),e.jsx(E,{children:O?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading variant groups..."}):$.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No variant groups yet. Create your first A/B test!"}):e.jsx("div",{className:"space-y-4",children:$.map(d=>e.jsx(xt,{variantGroup:d,ads:V,expanded:m.has(d),onToggle:()=>se(d)},d))})})]}),e.jsx(we,{open:w,onOpenChange:c,children:e.jsxs(Ce,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ke,{children:[e.jsx(De,{children:"Create A/B Test Variant Group"}),e.jsx(Se,{children:"Create multiple ad variants to test which performs best"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"variantGroupName",children:"Variant Group Name"}),e.jsx(v,{id:"variantGroupName",value:b,onChange:d=>P(d.target.value),placeholder:"e.g., homepage-banner-test-1"})]}),e.jsx(Z,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Variants"}),e.jsxs(g,{type:"button",variant:"outline",size:"sm",onClick:H,className:"gap-2",children:[e.jsx(Be,{className:"w-4 h-4"}),"Add Variant"]})]}),j.map((d,f)=>e.jsxs(T,{className:"border-2",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(B,{className:"text-base",children:["Variant ",d.variantName]}),j.length>2&&e.jsx(g,{type:"button",variant:"ghost",size:"sm",onClick:()=>y(f),children:e.jsx(Re,{className:"w-4 h-4"})})]})}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Title"}),e.jsx(v,{value:d.title,onChange:C=>D(f,"title",C.target.value),placeholder:"Ad title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Link URL"}),e.jsx(v,{value:d.linkUrl,onChange:C=>D(f,"linkUrl",C.target.value),placeholder:"https://..."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Image"}),e.jsx(qe,{value:d.imageUrl,onChange:C=>D(f,"imageUrl",C)})]}),f===0&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Type"}),e.jsxs(J,{value:d.type,onValueChange:C=>{j.forEach((L,u)=>D(u,"type",C))},children:[e.jsx(z,{children:e.jsx(_,{})}),e.jsxs(K,{children:[e.jsx(h,{value:"banner",children:"Banner"}),e.jsx(h,{value:"sidebar",children:"Sidebar"}),e.jsx(h,{value:"popup",children:"Popup"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Placement"}),e.jsxs(J,{value:d.placement,onValueChange:C=>{j.forEach((L,u)=>D(u,"placement",C))},children:[e.jsx(z,{children:e.jsx(_,{})}),e.jsxs(K,{children:[e.jsx(h,{value:"homepage",children:"Homepage"}),e.jsx(h,{value:"manga-page",children:"Manga Page"}),e.jsx(h,{value:"chapter-reader",children:"Chapter Reader"}),e.jsx(h,{value:"browse",children:"Browse"}),e.jsx(h,{value:"all",children:"All Pages"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Display Order"}),e.jsx(v,{type:"number",value:d.displayOrder,onChange:C=>{const L=parseInt(C.target.value)||0;j.forEach((u,t)=>D(t,"displayOrder",L))},min:"0"})]})]})]})]},f))]})]}),e.jsxs(Ae,{children:[e.jsx(g,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(g,{onClick:W,disabled:G.isPending,children:G.isPending?"Creating...":"Create Variant Group"})]})]})})]})}function xt({variantGroup:o,ads:N,expanded:w,onToggle:c}){const{data:b,isLoading:P}=Ge({queryKey:["variant-comparison",o],queryFn:()=>dt(o),enabled:w}),j=N.filter(m=>m.variantGroup===o),U=b?.reduce((m,F)=>F.ctr>m.ctr?F:m,b[0]);return e.jsxs(T,{className:"border-2",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"text-lg",children:o}),e.jsxs(k,{variant:"outline",children:[j.length," variants"]})]}),e.jsx(g,{variant:"ghost",size:"sm",onClick:c,children:w?"Hide Details":"Show Details"})]})}),w&&e.jsx(E,{children:P?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"Loading comparison..."}):!b||b.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No performance data yet"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(m=>e.jsxs(T,{className:U?.variantName===m.variantName?"border-green-500 border-2 bg-green-50 dark:bg-green-950/20":"border-border",children:[e.jsxs(R,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(B,{className:"text-base",children:["Variant ",m.variantName]}),U?.variantName===m.variantName&&e.jsxs(k,{className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Te,{className:"w-3 h-3 mr-1"}),"Winner"]})]}),e.jsx(Q,{className:"text-xs line-clamp-1",children:m.title})]}),e.jsxs(E,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(fe,{className:"w-3 h-3"}),"Impressions"]}),e.jsx("span",{className:"font-semibold",children:m.impressions.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(Ee,{className:"w-3 h-3"}),"Clicks"]}),e.jsx("span",{className:"font-semibold",children:m.clicks.toLocaleString()})]}),e.jsx(Z,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"CTR"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold",children:[m.ctr,"%"]}),U?.variantName===m.variantName?e.jsx(Te,{className:"w-4 h-4 text-green-600"}):e.jsx(xs,{className:"w-4 h-4 text-muted-foreground"})]})]})]})]},m.adId))})})]})}const je={homepage:[{value:"top_banner",label:"Top Banner"},{value:"sidebar",label:"Sidebar"},{value:"in_content_1",label:"In Content 1"},{value:"in_content_2",label:"In Content 2"},{value:"bottom_banner",label:"Bottom Banner"}],manga_detail:[{value:"top_banner",label:"Top Banner"},{value:"sidebar",label:"Sidebar"},{value:"in_content_1",label:"In Content 1"},{value:"bottom_banner",label:"Bottom Banner"}],reader:[{value:"top_banner",label:"Top Banner"},{value:"bottom_banner",label:"Bottom Banner"}],search_results:[{value:"top_banner",label:"Top Banner"},{value:"sidebar",label:"Sidebar"},{value:"in_content_1",label:"In Content 1"},{value:"bottom_banner",label:"Bottom Banner"}]},Ue=[{value:"homepage",label:"Homepage"},{value:"manga_detail",label:"Manga Detail Page"},{value:"reader",label:"Chapter Reader"},{value:"search_results",label:"Search Results"}];async function ht(){const o=await fetch("/api/admin/ads",{credentials:"include"});if(!o.ok)throw new Error("Failed to fetch advertisements");return o.json()}function Rt(){const{isAdmin:o,isAuthenticated:N}=Ls(),[,w]=Fs(),{toast:c}=ds(),b=os(),[P,j]=p.useState(""),[U,m]=p.useState(!1),[F,V]=p.useState(!1),[O,$]=p.useState(null),[G,H]=p.useState(null),[y,D]=p.useState(new Set),[ne,W]=p.useState(!1),[se,d]=p.useState(!1),[f,C]=p.useState(null),[L,u]=p.useState([]),[t,l]=p.useState({title:"",description:"",imageUrl:"",linkUrl:"",type:"banner",page:"homepage",location:"top_banner",displayOrder:0,startDate:"",endDate:"",isActive:!0,targetCountries:[],targetDeviceTypes:[],targetUserRoles:[],targetLanguages:[],budget:"",costPerClick:"",costPerImpression:"",conversionGoal:"",frequencyCap:0,dailyBudget:"",tags:[],notes:""}),{data:n,isLoading:Y}=Ge({queryKey:["admin-ads"],queryFn:ht,enabled:o&&N}),I=X({mutationFn:async s=>{const a={...s,isActive:s.isActive?"true":"false",displayOrder:Number(s.displayOrder)||0,startDate:s.startDate?.trim()||null,endDate:s.endDate?.trim()||null,targetCountries:s.targetCountries.length>0?JSON.stringify(s.targetCountries):null,targetDeviceTypes:s.targetDeviceTypes.length>0?JSON.stringify(s.targetDeviceTypes):null,targetUserRoles:s.targetUserRoles.length>0?JSON.stringify(s.targetUserRoles):null,targetLanguages:s.targetLanguages.length>0?JSON.stringify(s.targetLanguages):null,budget:s.budget?.trim()||null,costPerClick:s.costPerClick?.trim()||null,costPerImpression:s.costPerImpression?.trim()||null,conversionGoal:s.conversionGoal?.trim()||null,frequencyCap:s.frequencyCap>0?s.frequencyCap:null,dailyBudget:s.dailyBudget?.trim()||null,tags:s.tags.length>0?JSON.stringify(s.tags):null,notes:s.notes?.trim()||null};a.startDate===null&&delete a.startDate,a.endDate===null&&delete a.endDate,a.targetCountries===null&&delete a.targetCountries,a.targetDeviceTypes===null&&delete a.targetDeviceTypes,a.targetUserRoles===null&&delete a.targetUserRoles,a.targetLanguages===null&&delete a.targetLanguages,a.budget===null&&delete a.budget,a.costPerClick===null&&delete a.costPerClick,a.costPerImpression===null&&delete a.costPerImpression,a.conversionGoal===null&&delete a.conversionGoal,a.frequencyCap===null&&delete a.frequencyCap,a.dailyBudget===null&&delete a.dailyBudget,a.tags===null&&delete a.tags,a.notes===null&&delete a.notes;const r=await ee("/api/admin/ads",{method:"POST",body:JSON.stringify(a)});if(!r.ok){const S=await r.json();throw new Error(S.message||"Failed to create advertisement")}return r.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-ads"]}),c({title:"Success",description:"Advertisement created successfully"}),m(!1),Pe()},onError:s=>{c({title:"Error",description:s.message||"Failed to create advertisement",variant:"error"})}}),de=X({mutationFn:async({id:s,data:a})=>{const r={...a,isActive:a.isActive?"true":"false",displayOrder:Number(a.displayOrder)||0,startDate:a.startDate?.trim()||null,endDate:a.endDate?.trim()||null,targetCountries:a.targetCountries.length>0?JSON.stringify(a.targetCountries):null,targetDeviceTypes:a.targetDeviceTypes.length>0?JSON.stringify(a.targetDeviceTypes):null,targetUserRoles:a.targetUserRoles.length>0?JSON.stringify(a.targetUserRoles):null,targetLanguages:a.targetLanguages.length>0?JSON.stringify(a.targetLanguages):null,budget:a.budget?.trim()||null,costPerClick:a.costPerClick?.trim()||null,costPerImpression:a.costPerImpression?.trim()||null,conversionGoal:a.conversionGoal?.trim()||null,frequencyCap:a.frequencyCap>0?a.frequencyCap:null,dailyBudget:a.dailyBudget?.trim()||null,tags:a.tags.length>0?JSON.stringify(a.tags):null,notes:a.notes?.trim()||null};r.startDate===null&&delete r.startDate,r.endDate===null&&delete r.endDate,r.targetCountries===null&&delete r.targetCountries,r.targetDeviceTypes===null&&delete r.targetDeviceTypes,r.targetUserRoles===null&&delete r.targetUserRoles,r.targetLanguages===null&&delete r.targetLanguages,r.budget===null&&delete r.budget,r.costPerClick===null&&delete r.costPerClick,r.costPerImpression===null&&delete r.costPerImpression,r.conversionGoal===null&&delete r.conversionGoal,r.frequencyCap===null&&delete r.frequencyCap,r.dailyBudget===null&&delete r.dailyBudget,r.tags===null&&delete r.tags,r.notes===null&&delete r.notes;const S=await ee(`/api/admin/ads/${s}`,{method:"PATCH",body:JSON.stringify(r)});if(!S.ok){const A=await S.json();throw new Error(A.message||"Failed to update advertisement")}return S.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-ads"]}),c({title:"Success",description:"Advertisement updated successfully"}),V(!1),$(null),Pe()},onError:s=>{c({title:"Error",description:s.message||"Failed to update advertisement",variant:"error"})}}),me=X({mutationFn:async s=>{const a=await ee(`/api/admin/ads/${s}`,{method:"DELETE"});if(!a.ok){const r=await a.json();throw new Error(r.message||"Failed to delete advertisement")}return a.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-ads"]}),c({title:"Success",description:"Advertisement deleted successfully"}),H(null)},onError:s=>{c({title:"Error",description:s.message||"Failed to delete advertisement",variant:"error"})}}),ve=X({mutationFn:async({id:s,isActive:a})=>{const r=await ee(`/api/admin/ads/${s}`,{method:"PATCH",body:JSON.stringify({isActive:a?"true":"false"})});if(!r.ok){const S=await r.json();throw new Error(S.message||"Failed to toggle advertisement status")}return r.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-ads"]}),c({title:"Success",description:"Advertisement status updated successfully"})},onError:s=>{c({title:"Error",description:s.message||"Failed to update advertisement status",variant:"error"})}}),xe=X({mutationFn:async()=>{const s=await ee("/api/admin/ads/refresh-schedules",{method:"POST"});if(!s.ok){const a=await s.json();throw new Error(a.message||"Failed to refresh schedules")}return s.json()},onSuccess:s=>{b.invalidateQueries({queryKey:["admin-ads"]}),c({title:"Schedules Refreshed",description:s.message||`${s.activated} ads activated, ${s.deactivated} ads deactivated`})},onError:s=>{c({title:"Error",description:s.message||"Failed to refresh schedules",variant:"error"})}}),Ne=X({mutationFn:async s=>{const a=await ee("/api/admin/ads/bulk-enable",{method:"POST",body:JSON.stringify({ids:s})});if(!a.ok){const r=await a.json();throw new Error(r.message||"Failed to enable ads")}return a.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-ads"]}),c({title:"Success",description:`${y.size} ad(s) enabled successfully`}),D(new Set)},onError:s=>{c({title:"Error",description:s.message||"Failed to enable ads",variant:"error"})}}),be=X({mutationFn:async s=>{const a=await ee("/api/admin/ads/bulk-disable",{method:"POST",body:JSON.stringify({ids:s})});if(!a.ok){const r=await a.json();throw new Error(r.message||"Failed to disable ads")}return a.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-ads"]}),c({title:"Success",description:`${y.size} ad(s) disabled successfully`}),D(new Set)},onError:s=>{c({title:"Error",description:s.message||"Failed to disable ads",variant:"error"})}}),$e=X({mutationFn:async s=>{const a=await ee("/api/admin/ads/bulk-delete",{method:"POST",body:JSON.stringify({ids:s})});if(!a.ok){const r=await a.json();throw new Error(r.message||"Failed to delete ads")}return a.json()},onSuccess:()=>{b.invalidateQueries({queryKey:["admin-ads"]}),c({title:"Success",description:`${y.size} ad(s) deleted successfully`}),D(new Set),W(!1)},onError:s=>{c({title:"Error",description:s.message||"Failed to delete ads",variant:"error"})}}),Me=X({mutationFn:async s=>{const a=await ee("/api/admin/ads/import",{method:"POST",body:JSON.stringify({ads:s})});if(!a.ok){const r=await a.json();throw new Error(r.message||"Failed to import ads")}return a.json()},onSuccess:s=>{b.invalidateQueries({queryKey:["admin-ads"]}),s.errors&&s.errors.length>0?(u(s.errors),c({title:"Partial Import",description:`${s.success} ad(s) imported, ${s.errors.length} error(s)`,variant:"error"})):(c({title:"Success",description:`${s.success} ad(s) imported successfully`}),d(!1),C(null),u([]))},onError:s=>{c({title:"Error",description:s.message||"Failed to import ads",variant:"error"})}}),Fe=s=>{const a=new Date().toISOString();return!s.startDate&&!s.endDate?{status:"",badge:"",color:""}:s.endDate&&s.endDate<=a?{status:"expired",badge:"Expired",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300"}:s.startDate&&s.startDate>a?{status:"upcoming",badge:"Upcoming",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"}:s.startDate&&s.startDate<=a&&(!s.endDate||s.endDate>a)?{status:"active",badge:"Active",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"}:{status:"",badge:"",color:""}},ps=s=>{const a=new Set(y);a.has(s)?a.delete(s):a.add(s),D(a)},Je=async s=>{try{const a=await fetch(`/api/admin/ads/export?format=${s}`,{credentials:"include"});if(!a.ok)throw new Error("Failed to export ads");const r=await a.blob(),S=window.URL.createObjectURL(r),A=document.createElement("a");A.href=S,A.download=`ads-export-${new Date().toISOString().split("T")[0]}.${s}`,document.body.appendChild(A),A.click(),window.URL.revokeObjectURL(S),document.body.removeChild(A),c({title:"Success",description:`Ads exported as ${s.toUpperCase()} successfully`})}catch(a){c({title:"Error",description:a instanceof Error?a.message:"Failed to export ads",variant:"error"})}},gs=async s=>{const a=s.target.files?.[0];if(!a)return;C(a),u([]);const r=a.name.split(".").pop()?.toLowerCase();if(r==="json")try{const S=await a.text(),A=JSON.parse(S);if(!Array.isArray(A))throw new Error("JSON must be an array of advertisements");Me.mutate(A)}catch(S){let A="Failed to process JSON file";S instanceof SyntaxError?A="Invalid JSON format - please check the file syntax":S instanceof Error&&(S.message.includes("array")?A=S.message:S.message.includes("read")?A="Failed to read the file - please try again":A=S.message),c({title:"Import Error",description:A,variant:"error"})}else if(r==="csv"){const A=(await a.text()).split(`
`).filter(ue=>ue.trim());if(A.length<2){c({title:"Error",description:"CSV file must have headers and at least one data row",variant:"error"});return}const he=A[0].split(",").map(ue=>ue.trim()),x=A.slice(1).map((ue,ut)=>{const As=ue.split(",").map(q=>q.trim()),pe={};return he.forEach((q,Ts)=>{const ce=As[Ts]||"";q==="targetCountries"||q==="targetDeviceTypes"||q==="targetUserRoles"||q==="targetLanguages"||q==="tags"?pe[q]=ce?JSON.stringify(ce.split("|").map(Es=>Es.trim())):null:q==="displayOrder"||q==="frequencyCap"?pe[q]=ce?parseInt(ce):0:q==="isActive"?pe[q]=ce==="true"?"true":"false":ce&&(pe[q]=ce)}),pe});Me.mutate(x)}else c({title:"Error",description:"Please upload a CSV or JSON file",variant:"error"})};if(!N||!o)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-background/95 flex items-center justify-center p-4",children:e.jsxs(T,{className:"max-w-md w-full bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(R,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Us,{className:"w-8 h-8 text-primary"})}),e.jsx(B,{className:"text-2xl",children:"Admin Access Required"}),e.jsx(Q,{className:"mt-2",children:"You need admin privileges to access advertisement management"})]}),e.jsx(E,{children:e.jsx(g,{onClick:()=>w("/"),className:"w-full",children:"Return to Home"})})]})});const Pe=()=>{l({title:"",description:"",imageUrl:"",linkUrl:"",type:"banner",page:"homepage",location:"top_banner",displayOrder:0,startDate:"",endDate:"",isActive:!0,targetCountries:[],targetDeviceTypes:[],targetUserRoles:[],targetLanguages:[],budget:"",costPerClick:"",costPerImpression:"",conversionGoal:"",frequencyCap:0,dailyBudget:"",tags:[],notes:""})},js=()=>{if(!t.title.trim()){c({title:"Validation Error",description:"Title is required",variant:"error"});return}if(!t.imageUrl.trim()){c({title:"Validation Error",description:"Image URL is required",variant:"error"});return}if(!t.linkUrl.trim()){c({title:"Validation Error",description:"Link URL is required",variant:"error"});return}if(t.startDate&&t.endDate){const s=new Date(t.startDate),a=new Date(t.endDate);if(s>=a){c({title:"Validation Error",description:"Start date must be before end date",variant:"error"});return}}I.mutate(t)},fs=()=>{if(O){if(!t.title.trim()){c({title:"Validation Error",description:"Title is required",variant:"error"});return}if(!t.imageUrl.trim()){c({title:"Validation Error",description:"Image URL is required",variant:"error"});return}if(!t.linkUrl.trim()){c({title:"Validation Error",description:"Link URL is required",variant:"error"});return}if(t.startDate&&t.endDate){const s=new Date(t.startDate),a=new Date(t.endDate);if(s>=a){c({title:"Validation Error",description:"Start date must be before end date",variant:"error"});return}}de.mutate({id:O.id,data:t})}},vs=()=>{G&&me.mutate(G)},Ns=s=>{$(s);const a=r=>{if(!r)return[];try{return JSON.parse(r)}catch{return[]}};l({title:s.title,description:s.description||"",imageUrl:s.imageUrl,linkUrl:s.linkUrl,type:s.type,page:s.page,location:s.location,displayOrder:s.displayOrder,startDate:s.startDate||"",endDate:s.endDate||"",isActive:s.isActive==="true",targetCountries:a(s.targetCountries),targetDeviceTypes:a(s.targetDeviceTypes),targetUserRoles:a(s.targetUserRoles),targetLanguages:a(s.targetLanguages),budget:s.budget||"",costPerClick:s.costPerClick||"",costPerImpression:s.costPerImpression||"",conversionGoal:s.conversionGoal||"",frequencyCap:s.frequencyCap||0,dailyBudget:s.dailyBudget||"",tags:a(s.tags),notes:s.notes||""}),V(!0)},te=n?.filter(s=>s.title.toLowerCase().includes(P.toLowerCase())||s.type.toLowerCase().includes(P.toLowerCase())||s.page.toLowerCase().includes(P.toLowerCase())||s.location.toLowerCase().includes(P.toLowerCase()))||[],bs=()=>{y.size===te.length?D(new Set):D(new Set(te.map(s=>s.id)))},ys=te.length>0&&y.size===te.length,ws=y.size>0&&y.size<te.length,Cs=n?.length||0,ks=n?.filter(s=>s.isActive==="true").length||0,Ds=n?.reduce((s,a)=>s+a.clickCount,0)||0,Ss=n?.reduce((s,a)=>s+a.impressionCount,0)||0;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-background/95 p-2 sm:p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs(g,{variant:"ghost",onClick:()=>w("/admin"),className:"text-muted-foreground hover:text-primary min-h-11 w-full sm:w-auto justify-start",children:[e.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back to Admin"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-6 h-6 sm:w-8 sm:h-8 text-primary flex-shrink-0"}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold bg-gradient-to-r from-primary via-accent to-purple-400 bg-clip-text text-transparent",children:"Advertisement Management"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6 mb-6 sm:mb-8",children:[e.jsx(T,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(E,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Ads"}),e.jsx("p",{className:"text-2xl font-bold",children:Cs})]}),e.jsx(oe,{className:"w-8 h-8 text-primary"})]})})}),e.jsx(T,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(E,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Ads"}),e.jsx("p",{className:"text-2xl font-bold",children:ks})]}),e.jsx(es,{className:"w-8 h-8 text-green-500"})]})})}),e.jsx(T,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(E,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Clicks"}),e.jsx("p",{className:"text-2xl font-bold",children:Ds.toLocaleString()})]}),e.jsx(Ee,{className:"w-8 h-8 text-accent"})]})})}),e.jsx(T,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsx(E,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Impressions"}),e.jsx("p",{className:"text-2xl font-bold",children:Ss.toLocaleString()})]}),e.jsx(fe,{className:"w-8 h-8 text-purple-500"})]})})})]}),e.jsx("div",{className:"mb-8",children:e.jsx(Zs,{})}),e.jsxs(ns,{defaultValue:"ads",className:"w-full",children:[e.jsxs(cs,{className:"grid w-full max-w-3xl grid-cols-2 md:grid-cols-4 mb-6",children:[e.jsxs(re,{value:"ads",className:"flex items-center gap-1 md:gap-2 text-xs md:text-sm",children:[e.jsx(oe,{className:"w-3 h-3 md:w-4 md:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Ads Management"}),e.jsx("span",{className:"sm:hidden",children:"Ads"})]}),e.jsxs(re,{value:"schedule",className:"flex items-center gap-1 md:gap-2 text-xs md:text-sm",children:[e.jsx(ze,{className:"w-3 h-3 md:w-4 md:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Schedule"}),e.jsx("span",{className:"sm:hidden",children:"Schedule"})]}),e.jsxs(re,{value:"analytics",className:"flex items-center gap-1 md:gap-2 text-xs md:text-sm",children:[e.jsx(hs,{className:"w-3 h-3 md:w-4 md:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Analytics"}),e.jsx("span",{className:"sm:hidden",children:"Analytics"})]}),e.jsxs(re,{value:"ab-testing",className:"flex items-center gap-1 md:gap-2 text-xs md:text-sm",children:[e.jsx(as,{className:"w-3 h-3 md:w-4 md:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"A/B Testing"}),e.jsx("span",{className:"sm:hidden",children:"A/B Test"})]})]}),e.jsxs(le,{value:"ads",className:"mt-0",children:[y.size>0&&e.jsx("div",{className:"sticky top-0 z-10 mb-4 p-4 bg-primary/10 border border-primary/20 rounded-lg backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(et,{className:"w-5 h-5 text-primary"}),e.jsxs("span",{className:"font-medium",children:[y.size," ad(s) selected"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(g,{variant:"outline",onClick:()=>Ne.mutate(Array.from(y)),disabled:Ne.isPending,className:"h-10 sm:h-9",children:[e.jsx(lt,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Enable Selected"}),e.jsx("span",{className:"sm:hidden",children:"Enable"})]}),e.jsxs(g,{variant:"outline",onClick:()=>be.mutate(Array.from(y)),disabled:be.isPending,className:"h-10 sm:h-9",children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Disable Selected"}),e.jsx("span",{className:"sm:hidden",children:"Disable"})]}),e.jsxs(g,{variant:"destructive",onClick:()=>W(!0),className:"h-10 sm:h-9",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete Selected"}),e.jsx("span",{className:"sm:hidden",children:"Delete"})]}),e.jsxs(g,{variant:"ghost",onClick:()=>D(new Set),className:"h-10 sm:h-9",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Clear Selection"}),e.jsx("span",{className:"sm:hidden",children:"Clear"})]})]})]})}),e.jsxs(T,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5"}),"All Advertisements"]}),e.jsx(Q,{children:"Manage and monitor your advertisements"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:[e.jsxs(g,{variant:"outline",onClick:()=>Je("csv"),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(ss,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export CSV"}),e.jsx("span",{className:"sm:hidden",children:"CSV"})]}),e.jsxs(g,{variant:"outline",onClick:()=>Je("json"),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(ss,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export JSON"}),e.jsx("span",{className:"sm:hidden",children:"JSON"})]}),e.jsxs(g,{variant:"outline",onClick:()=>d(!0),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(is,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Import"}),e.jsx("span",{className:"sm:hidden",children:"Import"})]}),e.jsxs(g,{variant:"outline",onClick:()=>xe.mutate(),disabled:xe.isPending,className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(Is,{className:`w-4 h-4 sm:mr-2 ${xe.isPending?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"}),e.jsx("span",{className:"sm:hidden",children:"Refresh"})]}),e.jsxs(g,{onClick:()=>{Pe(),m(!0)},className:"w-full sm:w-auto h-10 sm:h-9",children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Create New Ad"]})]})]})}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Rs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(v,{placeholder:"Search ads by title, type, or placement...",value:P,onChange:s=>j(s.target.value),className:"pl-10 bg-background/50"})]}),te.length>0&&e.jsxs("div",{className:"flex items-center gap-2 justify-end sm:justify-start",children:[e.jsx(M,{checked:ys,onCheckedChange:bs,className:ws?"data-[state=checked]:bg-primary/50":""}),e.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:"Select All"})]})]}),Y?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading advertisements..."})}):te.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(oe,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:P?"No advertisements found matching your search.":"No advertisements yet. Create your first ad!"})]}):e.jsx("div",{className:"space-y-4",children:te.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row items-start gap-4 p-4 bg-background/50 rounded-lg border border-border/50",children:[e.jsxs("div",{className:"flex gap-3 sm:gap-4 w-full sm:w-auto",children:[e.jsx(M,{checked:y.has(s.id),onCheckedChange:()=>ps(s.id),className:"mt-1"}),e.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 bg-muted rounded-lg overflow-hidden flex-shrink-0",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ms,{className:"w-8 h-8 text-muted-foreground"})})}),e.jsxs("div",{className:"flex-1 sm:hidden",children:[e.jsx("h3",{className:"font-semibold text-base",children:s.title}),e.jsx("div",{className:"flex gap-2 mt-1",children:e.jsx(k,{className:s.isActive==="true"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300 text-xs":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300 text-xs",children:s.isActive==="true"?"Active":"Inactive"})})]})]}),e.jsxs("div",{className:"flex-1 min-w-0 w-full sm:w-auto",children:[e.jsxs("div",{className:"hidden sm:flex flex-wrap items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(k,{className:s.isActive==="true"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300",children:s.isActive==="true"?"Active":"Inactive"}),Fe(s).badge&&e.jsx(k,{className:Fe(s).color,children:Fe(s).badge})]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-2 sm:hidden",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsxs(k,{variant:"secondary",children:["Type: ",s.type]}),e.jsxs(k,{variant:"secondary",children:["Page: ",Ue.find(a=>a.value===s.page)?.label||s.page]}),e.jsxs(k,{variant:"secondary",children:["Location: ",je[s.page]?.find(a=>a.value===s.location)?.label||s.location]}),e.jsxs(k,{variant:"secondary",children:["Order: ",s.displayOrder]}),s.variantGroup&&e.jsxs(k,{className:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",children:[e.jsx(as,{className:"w-3 h-3 mr-1"}),"Variant ",s.variantName," (",s.variantGroup,")"]}),s.startDate&&e.jsxs(k,{variant:"outline",className:"text-xs",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),"Start: ",new Date(s.startDate).toLocaleDateString()]}),s.endDate&&e.jsxs(k,{variant:"outline",className:"text-xs",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),"End: ",new Date(s.endDate).toLocaleDateString()]}),s.targetCountries&&(()=>{try{const a=JSON.parse(s.targetCountries);if(a.length>0)return e.jsxs(k,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:[e.jsx(st,{className:"w-3 h-3 mr-1"}),a.slice(0,3).join(", "),a.length>3?` +${a.length-3}`:""]})}catch{}return null})(),s.targetDeviceTypes&&(()=>{try{const a=JSON.parse(s.targetDeviceTypes);if(a.length>0)return e.jsxs(k,{className:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300",children:[e.jsx(us,{className:"w-3 h-3 mr-1"}),a.join(", ")]})}catch{}return null})(),s.targetUserRoles&&(()=>{try{const a=JSON.parse(s.targetUserRoles);if(a.length>0)return e.jsxs(k,{className:"bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-300",children:[e.jsx(Bs,{className:"w-3 h-3 mr-1"}),a.join(", ")]})}catch{}return null})(),s.targetLanguages&&(()=>{try{const a=JSON.parse(s.targetLanguages);if(a.length>0)return e.jsxs(k,{className:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-300",children:[e.jsx(at,{className:"w-3 h-3 mr-1"}),a.slice(0,2).join(", "),a.length>2?` +${a.length-2}`:""]})}catch{}return null})(),s.budget&&e.jsxs(k,{className:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-300",children:[e.jsx(Le,{className:"w-3 h-3 mr-1"}),"Budget: $",s.budget]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.clickCount," clicks"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.impressionCount," impressions"]})]}),e.jsxs("a",{href:s.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-primary hover:underline",children:[e.jsx(Ie,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate max-w-[200px]",children:s.linkUrl})]})]})]}),e.jsxs("div",{className:"flex flex-row sm:flex-col gap-2 w-full sm:w-auto mt-3 sm:mt-0",children:[e.jsxs(g,{variant:"outline",onClick:()=>ve.mutate({id:s.id,isActive:s.isActive!=="true"}),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx("span",{className:"hidden sm:inline",children:s.isActive==="true"?"Deactivate":"Activate"}),e.jsx("span",{className:"sm:hidden",children:s.isActive==="true"?"Off":"On"})]}),e.jsxs(g,{variant:"outline",onClick:()=>Ns(s),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(tt,{className:"w-4 h-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),e.jsxs(g,{variant:"destructive",onClick:()=>H(s.id),className:"flex-1 sm:flex-none h-10 sm:h-9",children:[e.jsx(Re,{className:"w-4 h-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]})]},s.id))})]})]})]}),e.jsx(le,{value:"schedule",className:"mt-0",children:e.jsx("div",{className:"space-y-4",children:(()=>{const s=new Date().toISOString(),a=n?.filter(x=>x.startDate&&x.startDate>s)||[],r=n?.filter(x=>x.isActive==="true"&&x.startDate&&x.startDate<=s&&(!x.endDate||x.endDate>s))||[],S=n?.filter(x=>x.endDate&&x.endDate<=s)||[],A=new Date(Date.now()-10080*60*1e3).toISOString(),he=S.filter(x=>x.endDate&&x.endDate>=A);return e.jsxs(e.Fragment,{children:[e.jsxs(T,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-blue-500"}),"Upcoming Ads (",a.length,")"]}),e.jsx(Q,{children:"Ads scheduled to start in the future"})]}),e.jsx(E,{children:a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No upcoming scheduled ads"}):e.jsx("div",{className:"space-y-3",children:a.map(x=>e.jsx("div",{className:"p-3 bg-background/50 rounded-lg border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:x.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx(ge,{className:"w-3 h-3 inline mr-1"}),"Starts: ",new Date(x.startDate).toLocaleDateString()," at ",new Date(x.startDate).toLocaleTimeString()]}),x.endDate&&e.jsxs("span",{className:"text-muted-foreground",children:["â€¢ Ends: ",new Date(x.endDate).toLocaleDateString()]})]})]}),e.jsx(k,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:"Upcoming"})]})},x.id))})})]}),e.jsxs(T,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(es,{className:"w-5 h-5 text-green-500"}),"Currently Active Scheduled Ads (",r.length,")"]}),e.jsx(Q,{children:"Active ads with scheduled end dates"})]}),e.jsx(E,{children:r.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No active scheduled ads"}):e.jsx("div",{className:"space-y-3",children:r.map(x=>e.jsx("div",{className:"p-3 bg-background/50 rounded-lg border border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:x.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx(ge,{className:"w-3 h-3 inline mr-1"}),"Ends: ",new Date(x.endDate).toLocaleDateString()," at ",new Date(x.endDate).toLocaleTimeString()]}),e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["â€¢ ",x.clickCount," clicks, ",x.impressionCount," impressions"]})]})]}),e.jsx(k,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",children:"Active"})]})},x.id))})})]}),e.jsxs(T,{className:"bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(R,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"w-5 h-5 text-red-500"}),"Recently Expired (",he.length,")"]}),e.jsx(Q,{children:"Ads that expired in the last 7 days"})]}),e.jsx(E,{children:he.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No recently expired ads"}):e.jsx("div",{className:"space-y-3",children:he.map(x=>e.jsx("div",{className:"p-3 bg-background/50 rounded-lg border border-red-200 dark:border-red-800",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:x.title}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[e.jsx(ge,{className:"w-3 h-3 inline mr-1"}),"Expired: ",new Date(x.endDate).toLocaleDateString()," at ",new Date(x.endDate).toLocaleTimeString()]}),e.jsxs("span",{className:"text-red-600 dark:text-red-400",children:["â€¢ Final stats: ",x.clickCount," clicks, ",x.impressionCount," impressions"]})]})]}),e.jsx(k,{className:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",children:"Expired"})]})},x.id))})})]})]})})()})}),e.jsx(le,{value:"analytics",className:"mt-0",children:e.jsx(nt,{ads:n||[]})}),e.jsx(le,{value:"ab-testing",className:"mt-0",children:e.jsx(mt,{})})]}),e.jsx(we,{open:U,onOpenChange:m,children:e.jsxs(Ce,{className:"w-[95vw] max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ke,{children:[e.jsx(De,{children:"Create New Advertisement"}),e.jsx(Se,{children:"Add a new advertisement to display on your site"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-title",children:"Title *"}),e.jsx(v,{id:"create-title",value:t.title,onChange:s=>l({...t,title:s.target.value}),placeholder:"Enter ad title"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-description",children:"Description"}),e.jsx(ye,{id:"create-description",value:t.description,onChange:s=>l({...t,description:s.target.value}),placeholder:"Enter ad description (optional)",rows:3})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Ad Image *"}),e.jsx(qe,{value:t.imageUrl,onChange:s=>l({...t,imageUrl:s}),accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",maxSize:10,uploadEndpoint:"/api/admin/upload-ad-image"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-linkUrl",children:"Link URL *"}),e.jsx(v,{id:"create-linkUrl",value:t.linkUrl,onChange:s=>l({...t,linkUrl:s.target.value}),placeholder:"https://example.com/landing-page"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-type",children:"Type"}),e.jsxs(J,{value:t.type,onValueChange:s=>l({...t,type:s}),children:[e.jsx(z,{id:"create-type",children:e.jsx(_,{})}),e.jsxs(K,{children:[e.jsx(h,{value:"banner",children:"Banner"}),e.jsx(h,{value:"sidebar",children:"Sidebar"}),e.jsx(h,{value:"popup",children:"Popup"}),e.jsx(h,{value:"inline",children:"Inline"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-displayOrder",children:"Display Order"}),e.jsx(v,{id:"create-displayOrder",type:"number",value:t.displayOrder,onChange:s=>l({...t,displayOrder:parseInt(s.target.value)||0}),placeholder:"0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-page",children:"Page *"}),e.jsxs(J,{value:t.page,onValueChange:s=>{const r=(je[s]||[])[0]?.value||"top_banner";l({...t,page:s,location:r})},children:[e.jsx(z,{id:"create-page",children:e.jsx(_,{})}),e.jsx(K,{children:Ue.map(s=>e.jsx(h,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-location",children:"Location *"}),e.jsxs(J,{value:t.location,onValueChange:s=>l({...t,location:s}),children:[e.jsx(z,{id:"create-location",children:e.jsx(_,{})}),e.jsx(K,{children:(je[t.page]||[]).map(s=>e.jsx(h,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-startDate",children:"Start Date (Optional)"}),e.jsx(v,{id:"create-startDate",type:"datetime-local",value:t.startDate,onChange:s=>l({...t,startDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-endDate",children:"End Date (Optional)"}),e.jsx(v,{id:"create-endDate",type:"datetime-local",value:t.endDate,onChange:s=>l({...t,endDate:s.target.value})})]})]}),e.jsx(Z,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"}),"Advanced Targeting"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty to target all users"}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Countries"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:["US","UK","CA","AU","DE","FR","JP","ES","IT","BR"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`create-country-${s}`,checked:t.targetCountries.includes(s),onCheckedChange:a=>{l({...t,targetCountries:a?[...t.targetCountries,s]:t.targetCountries.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`create-country-${s}`,className:"text-xs cursor-pointer",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Device Types"}),e.jsx("div",{className:"flex gap-4 mt-2",children:["mobile","tablet","desktop"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`create-device-${s}`,checked:t.targetDeviceTypes.includes(s),onCheckedChange:a=>{l({...t,targetDeviceTypes:a?[...t.targetDeviceTypes,s]:t.targetDeviceTypes.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`create-device-${s}`,className:"text-xs cursor-pointer capitalize",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target User Roles"}),e.jsx("div",{className:"flex gap-4 mt-2",children:["user","premium","staff","admin"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`create-role-${s}`,checked:t.targetUserRoles.includes(s),onCheckedChange:a=>{l({...t,targetUserRoles:a?[...t.targetUserRoles,s]:t.targetUserRoles.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`create-role-${s}`,className:"text-xs cursor-pointer capitalize",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Languages"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"},{code:"ja",name:"Japanese"},{code:"zh",name:"Chinese"}].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`create-lang-${s.code}`,checked:t.targetLanguages.includes(s.code),onCheckedChange:a=>{l({...t,targetLanguages:a?[...t.targetLanguages,s.code]:t.targetLanguages.filter(r=>r!==s.code)})}}),e.jsx(i,{htmlFor:`create-lang-${s.code}`,className:"text-xs cursor-pointer",children:s.name})]},s.code))})]})]}),e.jsx(Z,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4"}),"Performance & Budget"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-budget",className:"text-xs",children:"Total Budget ($)"}),e.jsx(v,{id:"create-budget",value:t.budget,onChange:s=>l({...t,budget:s.target.value}),placeholder:"e.g., 1000.00",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-dailyBudget",className:"text-xs",children:"Daily Budget ($)"}),e.jsx(v,{id:"create-dailyBudget",value:t.dailyBudget,onChange:s=>l({...t,dailyBudget:s.target.value}),placeholder:"e.g., 50.00",className:"text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-costPerClick",className:"text-xs",children:"Cost Per Click ($)"}),e.jsx(v,{id:"create-costPerClick",value:t.costPerClick,onChange:s=>l({...t,costPerClick:s.target.value}),placeholder:"e.g., 0.50",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-costPerImpression",className:"text-xs",children:"Cost Per Impression ($)"}),e.jsx(v,{id:"create-costPerImpression",value:t.costPerImpression,onChange:s=>l({...t,costPerImpression:s.target.value}),placeholder:"e.g., 0.01",className:"text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-conversionGoal",className:"text-xs",children:"Conversion Goal"}),e.jsxs(J,{value:t.conversionGoal,onValueChange:s=>l({...t,conversionGoal:s}),children:[e.jsx(z,{id:"create-conversionGoal",className:"text-sm",children:e.jsx(_,{placeholder:"Select goal"})}),e.jsxs(K,{children:[e.jsx(h,{value:"click",children:"Click"}),e.jsx(h,{value:"signup",children:"Sign Up"}),e.jsx(h,{value:"purchase",children:"Purchase"}),e.jsx(h,{value:"download",children:"Download"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-frequencyCap",className:"text-xs",children:"Frequency Cap (per user/day)"}),e.jsx(v,{id:"create-frequencyCap",type:"number",value:t.frequencyCap||"",onChange:s=>l({...t,frequencyCap:parseInt(s.target.value)||0}),placeholder:"e.g., 3",className:"text-sm"})]})]})]}),e.jsx(Z,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ts,{className:"w-4 h-4"}),"Metadata"]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-tags",className:"text-xs",children:"Tags (comma-separated)"}),e.jsx(v,{id:"create-tags",value:t.tags.join(", "),onChange:s=>{const a=s.target.value.split(",").map(r=>r.trim()).filter(r=>r);l({...t,tags:a})},placeholder:"e.g., seasonal, promo, featured",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"create-notes",className:"text-xs",children:"Internal Notes"}),e.jsx(ye,{id:"create-notes",value:t.notes,onChange:s=>l({...t,notes:s.target.value}),placeholder:"Add internal notes for this ad...",rows:3,className:"text-sm"})]})]}),e.jsx(Z,{className:"my-4"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:"create-isActive",checked:t.isActive,onCheckedChange:s=>l({...t,isActive:s})}),e.jsx(i,{htmlFor:"create-isActive",className:"cursor-pointer",children:"Active (Display this ad immediately)"})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(rs,{title:t.title,description:t.description,imageUrl:t.imageUrl,linkUrl:t.linkUrl,type:t.type,page:t.page,location:t.location})})]}),e.jsxs(Ae,{children:[e.jsx(g,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(g,{onClick:js,disabled:I.isPending,children:I.isPending?"Creating...":"Create Ad"})]})]})}),e.jsx(we,{open:F,onOpenChange:V,children:e.jsxs(Ce,{className:"w-[95vw] max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ke,{children:[e.jsx(De,{children:"Edit Advertisement"}),e.jsx(Se,{children:"Update advertisement details"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-title",children:"Title *"}),e.jsx(v,{id:"edit-title",value:t.title,onChange:s=>l({...t,title:s.target.value}),placeholder:"Enter ad title"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-description",children:"Description"}),e.jsx(ye,{id:"edit-description",value:t.description,onChange:s=>l({...t,description:s.target.value}),placeholder:"Enter ad description (optional)",rows:3})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Ad Image *"}),e.jsx(qe,{value:t.imageUrl,onChange:s=>l({...t,imageUrl:s}),accept:"image/jpeg,image/jpg,image/png,image/webp,image/gif",maxSize:10,uploadEndpoint:"/api/admin/upload-ad-image"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-linkUrl",children:"Link URL *"}),e.jsx(v,{id:"edit-linkUrl",value:t.linkUrl,onChange:s=>l({...t,linkUrl:s.target.value}),placeholder:"https://example.com/landing-page"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-type",children:"Type"}),e.jsxs(J,{value:t.type,onValueChange:s=>l({...t,type:s}),children:[e.jsx(z,{id:"edit-type",children:e.jsx(_,{})}),e.jsxs(K,{children:[e.jsx(h,{value:"banner",children:"Banner"}),e.jsx(h,{value:"sidebar",children:"Sidebar"}),e.jsx(h,{value:"popup",children:"Popup"}),e.jsx(h,{value:"inline",children:"Inline"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-displayOrder",children:"Display Order"}),e.jsx(v,{id:"edit-displayOrder",type:"number",value:t.displayOrder,onChange:s=>l({...t,displayOrder:parseInt(s.target.value)||0}),placeholder:"0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-page",children:"Page *"}),e.jsxs(J,{value:t.page,onValueChange:s=>{const r=(je[s]||[])[0]?.value||"top_banner";l({...t,page:s,location:r})},children:[e.jsx(z,{id:"edit-page",children:e.jsx(_,{})}),e.jsx(K,{children:Ue.map(s=>e.jsx(h,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-location",children:"Location *"}),e.jsxs(J,{value:t.location,onValueChange:s=>l({...t,location:s}),children:[e.jsx(z,{id:"edit-location",children:e.jsx(_,{})}),e.jsx(K,{children:(je[t.page]||[]).map(s=>e.jsx(h,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-startDate",children:"Start Date (Optional)"}),e.jsx(v,{id:"edit-startDate",type:"datetime-local",value:t.startDate,onChange:s=>l({...t,startDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-endDate",children:"End Date (Optional)"}),e.jsx(v,{id:"edit-endDate",type:"datetime-local",value:t.endDate,onChange:s=>l({...t,endDate:s.target.value})})]})]}),e.jsx(Z,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"}),"Advanced Targeting"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty to target all users"}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Countries"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:["US","UK","CA","AU","DE","FR","JP","ES","IT","BR"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`edit-country-${s}`,checked:t.targetCountries.includes(s),onCheckedChange:a=>{l({...t,targetCountries:a?[...t.targetCountries,s]:t.targetCountries.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`edit-country-${s}`,className:"text-xs cursor-pointer",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Device Types"}),e.jsx("div",{className:"flex gap-4 mt-2",children:["mobile","tablet","desktop"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`edit-device-${s}`,checked:t.targetDeviceTypes.includes(s),onCheckedChange:a=>{l({...t,targetDeviceTypes:a?[...t.targetDeviceTypes,s]:t.targetDeviceTypes.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`edit-device-${s}`,className:"text-xs cursor-pointer capitalize",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target User Roles"}),e.jsx("div",{className:"flex gap-4 mt-2",children:["user","premium","staff","admin"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`edit-role-${s}`,checked:t.targetUserRoles.includes(s),onCheckedChange:a=>{l({...t,targetUserRoles:a?[...t.targetUserRoles,s]:t.targetUserRoles.filter(r=>r!==s)})}}),e.jsx(i,{htmlFor:`edit-role-${s}`,className:"text-xs cursor-pointer capitalize",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs",children:"Target Languages"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:[{code:"en",name:"English"},{code:"es",name:"Spanish"},{code:"fr",name:"French"},{code:"de",name:"German"},{code:"ja",name:"Japanese"},{code:"zh",name:"Chinese"}].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:`edit-lang-${s.code}`,checked:t.targetLanguages.includes(s.code),onCheckedChange:a=>{l({...t,targetLanguages:a?[...t.targetLanguages,s.code]:t.targetLanguages.filter(r=>r!==s.code)})}}),e.jsx(i,{htmlFor:`edit-lang-${s.code}`,className:"text-xs cursor-pointer",children:s.name})]},s.code))})]})]}),e.jsx(Z,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4"}),"Performance & Budget"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-budget",className:"text-xs",children:"Total Budget ($)"}),e.jsx(v,{id:"edit-budget",value:t.budget,onChange:s=>l({...t,budget:s.target.value}),placeholder:"e.g., 1000.00",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-dailyBudget",className:"text-xs",children:"Daily Budget ($)"}),e.jsx(v,{id:"edit-dailyBudget",value:t.dailyBudget,onChange:s=>l({...t,dailyBudget:s.target.value}),placeholder:"e.g., 50.00",className:"text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-costPerClick",className:"text-xs",children:"Cost Per Click ($)"}),e.jsx(v,{id:"edit-costPerClick",value:t.costPerClick,onChange:s=>l({...t,costPerClick:s.target.value}),placeholder:"e.g., 0.50",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-costPerImpression",className:"text-xs",children:"Cost Per Impression ($)"}),e.jsx(v,{id:"edit-costPerImpression",value:t.costPerImpression,onChange:s=>l({...t,costPerImpression:s.target.value}),placeholder:"e.g., 0.01",className:"text-sm"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-conversionGoal",className:"text-xs",children:"Conversion Goal"}),e.jsxs(J,{value:t.conversionGoal,onValueChange:s=>l({...t,conversionGoal:s}),children:[e.jsx(z,{id:"edit-conversionGoal",className:"text-sm",children:e.jsx(_,{placeholder:"Select goal"})}),e.jsxs(K,{children:[e.jsx(h,{value:"click",children:"Click"}),e.jsx(h,{value:"signup",children:"Sign Up"}),e.jsx(h,{value:"purchase",children:"Purchase"}),e.jsx(h,{value:"download",children:"Download"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-frequencyCap",className:"text-xs",children:"Frequency Cap (per user/day)"}),e.jsx(v,{id:"edit-frequencyCap",type:"number",value:t.frequencyCap||"",onChange:s=>l({...t,frequencyCap:parseInt(s.target.value)||0}),placeholder:"e.g., 3",className:"text-sm"})]})]})]}),e.jsx(Z,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(ts,{className:"w-4 h-4"}),"Metadata"]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-tags",className:"text-xs",children:"Tags (comma-separated)"}),e.jsx(v,{id:"edit-tags",value:t.tags.join(", "),onChange:s=>{const a=s.target.value.split(",").map(r=>r.trim()).filter(r=>r);l({...t,tags:a})},placeholder:"e.g., seasonal, promo, featured",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"edit-notes",className:"text-xs",children:"Internal Notes"}),e.jsx(ye,{id:"edit-notes",value:t.notes,onChange:s=>l({...t,notes:s.target.value}),placeholder:"Add internal notes for this ad...",rows:3,className:"text-sm"})]})]}),e.jsx(Z,{className:"my-4"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{id:"edit-isActive",checked:t.isActive,onCheckedChange:s=>l({...t,isActive:s})}),e.jsx(i,{htmlFor:"edit-isActive",className:"cursor-pointer",children:"Active (Display this ad)"})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(rs,{title:t.title,description:t.description,imageUrl:t.imageUrl,linkUrl:t.linkUrl,type:t.type,page:t.page,location:t.location})})]}),e.jsxs(Ae,{children:[e.jsx(g,{variant:"outline",onClick:()=>V(!1),children:"Cancel"}),e.jsx(g,{onClick:fs,disabled:de.isPending,children:de.isPending?"Saving...":"Save Changes"})]})]})}),e.jsx(_e,{open:G!==null,onOpenChange:s=>!s&&H(null),children:e.jsxs(Ke,{children:[e.jsxs(Qe,{children:[e.jsx(He,{children:"Are you sure?"}),e.jsx(We,{children:"This will permanently delete this advertisement. This action cannot be undone."})]}),e.jsxs(Ye,{children:[e.jsx(Xe,{children:"Cancel"}),e.jsx(Ze,{onClick:vs,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:me.isPending?"Deleting...":"Delete"})]})]})}),e.jsx(_e,{open:ne,onOpenChange:W,children:e.jsxs(Ke,{children:[e.jsxs(Qe,{children:[e.jsx(He,{children:"Delete Multiple Ads?"}),e.jsxs(We,{children:["This will permanently delete ",y.size," advertisement(s). This action cannot be undone."]})]}),e.jsxs(Ye,{children:[e.jsx(Xe,{children:"Cancel"}),e.jsx(Ze,{onClick:()=>$e.mutate(Array.from(y)),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:$e.isPending?"Deleting...":`Delete ${y.size} Ad(s)`})]})]})}),e.jsx(we,{open:se,onOpenChange:d,children:e.jsxs(Ce,{className:"w-[95vw] max-w-2xl",children:[e.jsxs(ke,{children:[e.jsx(De,{children:"Import Advertisements"}),e.jsx(Se,{children:"Upload a CSV or JSON file to bulk import advertisements"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"import-file",children:"Select File"}),e.jsx(v,{id:"import-file",type:"file",accept:".csv,.json",onChange:gs,className:"mt-2"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Accepted formats: CSV, JSON"})]}),f&&e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Selected file: ",f.name]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Size: ",(f.size/1024).toFixed(2)," KB"]})]}),L.length>0&&e.jsxs("div",{className:"mt-4 p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-destructive mb-2",children:"Validation Errors"}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:L.map((s,a)=>e.jsxs("p",{className:"text-sm text-destructive",children:["Row ",s.row,": ",s.field," - ",s.message]},a))})]}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"CSV Format Example:"}),e.jsx("pre",{className:"text-xs overflow-x-auto p-2 bg-background rounded",children:`title,description,imageUrl,linkUrl,type,placement,isActive,displayOrder
"Sample Ad","Description","/uploads/ad.jpg","https://example.com","banner","homepage","true",1`}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"For array fields (targetCountries, tags, etc.), use pipe-delimited values: US|UK|CA"})]})]}),e.jsx(Ae,{children:e.jsx(g,{variant:"outline",onClick:()=>{d(!1),C(null),u([])},children:"Close"})})]})})]})})}export{Rt as default};
