import{j as e}from"./ui-vendor-_s0klCrL.js";import{u as B,b as t}from"./react-vendor-C7VPsBAG.js";import{c as I,u as P,_ as D,N as w,ae as p,S as $,B as f,A as O,ak as y,C as i,k as n,an as Y,h as j,i as u,I as v,af as H,F as U,a2 as q}from"./index-BLJ_ytcB.js";import{G}from"./gift-lTXnbkoc.js";import"./utils-vendor-DYGWDIxX.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=I("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);function _(){const[,l]=B(),{isAuthenticated:o,isLoading:m}=P(),{toast:c}=D(),[s,C]=t.useState(null),[d,R]=t.useState([]),[k,S]=t.useState(!0),[E,b]=t.useState(!1),[x,N]=t.useState(""),h=t.useCallback(async()=>{try{const[r,a]=await Promise.all([fetch("/api/referrals/my-code",{credentials:"include"}),fetch("/api/referrals/my-referrals",{credentials:"include"})]);if(r.ok){const g=await r.json();C(g)}if(a.ok){const g=await a.json();R(g)}}catch{}finally{S(!1)}},[]);t.useEffect(()=>{!m&&!o?l("/login?returnTo=/referrals"):o&&h()},[m,o,l,h]);const L=()=>{if(s){const r=`${window.location.origin}/signup?ref=${s.code}`;navigator.clipboard.writeText(r),b(!0),c({title:"Copied!",description:"Referral link copied to clipboard"}),setTimeout(()=>b(!1),2e3)}},A=async()=>{if(!x.trim()){c({title:"Error",description:"Please enter a referral code",variant:"error"});return}try{const r=await fetch("/api/referrals/apply",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:JSON.stringify({code:x})}),a=await r.json();if(!r.ok)throw new Error(a.message||"Failed to apply code");c({title:"Success!",description:`You received ${a.coinsEarned} coins!`}),N(""),h()}catch(r){c({title:"Error",description:r.message,variant:"error"})}};if(m||k)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(w,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-20",children:[e.jsx(p,{className:"h-12 w-96 mb-6 bg-gray-800"}),e.jsx(p,{className:"h-64 mb-6 bg-gray-800"}),e.jsx(p,{className:"h-96 bg-gray-800"})]})]});if(!o)return l("/login?returnTo=/referrals"),null;const T=d.reduce((r,a)=>r+a.rewardAmount,0),F=s?`${window.location.origin}/signup?ref=${s.code}`:"";return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx($,{title:"Referral Program - Invite Friends & Earn Bonus Coins",description:"Invite friends to AmourScans and earn bonus coins for every successful referral. Both you and your friends get rewards when they join!",keywords:"referral program, invite friends, earn coins, referral rewards, bonus coins, refer and earn"}),e.jsx(w,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-16",children:[e.jsxs(f,{variant:"ghost",onClick:()=>l("/"),className:"w-fit text-muted-foreground hover:text-primary mb-4",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-full mb-6",children:[e.jsx(y,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"text-sm font-semibold text-primary",children:"Referral Program"})]}),e.jsx("h1",{className:"text-4xl sm:text-6xl font-bold text-white mb-4",children:"Invite Friends, Earn Coins"}),e.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:"Share your referral link and both you and your friends get bonus coins!"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(i,{className:"bg-gray-900/50 border-gray-800",children:e.jsxs(n,{className:"p-6 text-center",children:[e.jsx(y,{className:"w-12 h-12 mx-auto mb-3 text-primary"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:d.length}),e.jsx("p",{className:"text-sm text-gray-400",children:"Friends Referred"})]})}),e.jsx(i,{className:"bg-gray-900/50 border-gray-800",children:e.jsxs(n,{className:"p-6 text-center",children:[e.jsx(G,{className:"w-12 h-12 mx-auto mb-3 text-amber-500"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:T.toLocaleString()}),e.jsx("p",{className:"text-sm text-gray-400",children:"Coins Earned"})]})}),e.jsx(i,{className:"bg-gray-900/50 border-gray-800",children:e.jsxs(n,{className:"p-6 text-center",children:[e.jsx(Y,{className:"w-12 h-12 mx-auto mb-3 text-green-500"}),e.jsx("div",{className:"text-3xl font-bold text-white mb-1",children:s?.coinRewardReferrer||0}),e.jsx("p",{className:"text-sm text-gray-400",children:"Coins Per Referral"})]})})]}),e.jsxs(i,{className:"bg-gradient-to-br from-primary/20 to-accent/20 border-primary/40 mb-8",children:[e.jsx(j,{children:e.jsx(u,{className:"text-white text-2xl",children:"Your Referral Link"})}),e.jsxs(n,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx(v,{value:F,readOnly:!0,className:"bg-gray-900 border-gray-700 text-white font-mono text-sm"}),e.jsx(f,{onClick:L,className:"bg-primary hover:bg-primary/90 shrink-0",children:E?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Copy"]})})]}),e.jsx("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-gray-300",children:[e.jsx("strong",{className:"text-primary",children:"Reward:"})," You get"," ",e.jsxs("span",{className:"text-white font-semibold",children:[s?.coinRewardReferrer||0," coins"]})," ","and your friend gets"," ",e.jsxs("span",{className:"text-white font-semibold",children:[s?.coinRewardReferred||0," coins"]})]})})]})]}),e.jsxs(i,{className:"bg-gray-900/50 border-gray-800 mb-8",children:[e.jsx(j,{children:e.jsx(u,{className:"text-white",children:"Have a Referral Code?"})}),e.jsx(n,{className:"space-y-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(v,{placeholder:"Enter referral code",value:x,onChange:r=>N(r.target.value),className:"bg-gray-800 border-gray-700 text-white"}),e.jsx(f,{onClick:A,className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90",children:"Apply Code"})]})})]}),e.jsxs(i,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(j,{children:e.jsx(u,{className:"text-white",children:"Your Referrals"})}),e.jsx(n,{children:d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(y,{className:"w-16 h-16 mx-auto mb-4 text-gray-600"}),e.jsx("p",{className:"text-gray-400",children:"No referrals yet. Start inviting friends!"})]}):e.jsx("div",{className:"space-y-3",children:d.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:r.referredUsername}),e.jsx("p",{className:"text-sm text-gray-400",children:new Date(r.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(U,{className:r.status==="completed"?"bg-green-500/20 text-green-500 border-green-500/30":"bg-yellow-500/20 text-yellow-500 border-yellow-500/30",children:r.status}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["+",r.rewardAmount," coins"]})]})]},r.id))})})]})]}),e.jsx(q,{})]})}export{_ as default};
