import{j as e}from"./ui-vendor-_s0klCrL.js";import{u as b,b as h}from"./react-vendor-C7VPsBAG.js";import{u as j,_ as N,b as y,N as g,ae as u,S as v,B as x,A as w,C as p,a9 as P,az as k,a2 as S,Y as C}from"./index-BLJ_ytcB.js";import{P as L}from"./progress-CS8SLfk3.js";import{Z as f}from"./zap-JsjwqhbD.js";import{P as T}from"./percent-Bdg2aQgN.js";import{S as F}from"./shopping-cart-CoPQWzz9.js";import"./utils-vendor-DYGWDIxX.js";function E({endTime:r}){const[l,o]=h.useState("");return h.useEffect(()=>{const i=()=>{const c=new Date(r).getTime(),d=new Date().getTime(),s=c-d;if(s<0){o("EXPIRED");return}const a=Math.floor(s/(1e3*60*60)),t=Math.floor(s%(1e3*60*60)/(1e3*60)),m=Math.floor(s%(1e3*60)/1e3);o(`${a}h ${t}m ${m}s`)};i();const n=setInterval(i,1e3);return()=>clearInterval(n)},[r]),e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx(C,{className:"w-5 h-5 text-red-500 animate-pulse"}),e.jsx("span",{className:"font-mono font-bold text-lg",children:l})]})}function B(){const[,r]=b(),{isAuthenticated:l,isLoading:o}=j(),{toast:i}=N(),{data:n,isLoading:c}=y({queryKey:["/api/flash-sales/active"],queryFn:async()=>{const s=await fetch("/api/flash-sales/active",{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch flash sales");return s.json()},refetchInterval:3e4}),d=async s=>{if(!l){r("/login?returnTo=/flash-sales");return}try{const a=await fetch("/api/flash-sales/purchase",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:JSON.stringify({saleId:s})}),t=await a.json();if(!a.ok)throw new Error(t.message||"Failed to purchase");i({title:"Purchase Successful!",description:`${t.coinsReceived} coins added to your account`})}catch(a){i({title:"Purchase Failed",description:a.message,variant:"error"})}};return o||c?e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(g,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-20",children:[e.jsx(u,{className:"h-12 w-96 mx-auto mb-12 bg-gray-800"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[1,2].map(s=>e.jsx(u,{className:"h-64 bg-gray-800"},s))})]})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(v,{title:"Flash Sales - Limited Time Manga Deals & Discounts",description:"Grab exclusive limited-time manga deals before they're gone. Get massive discounts on coins and premium content with our flash sales, special offers, and deals.",keywords:"flash sales, manga deals, limited offers, discount coins, manga sales, special deals"}),e.jsx(g,{}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-16",children:[e.jsxs(x,{variant:"ghost",onClick:()=>r("/"),className:"w-fit text-muted-foreground hover:text-primary mb-4 min-h-11",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-red-500/10 border border-red-500/20 rounded-full mb-6 animate-pulse",children:[e.jsx(f,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-sm font-semibold text-red-500",children:"LIMITED TIME ONLY"})]}),e.jsx("h1",{className:"text-4xl sm:text-6xl font-bold text-white mb-4",children:"âš¡ Flash Sales"}),e.jsx("p",{className:"text-gray-400 text-lg max-w-2xl mx-auto",children:"Grab exclusive deals before they're gone! Limited quantity and time offers"})]}),!n||n.length===0?e.jsxs(p,{className:"bg-gray-900/50 border-gray-800 text-center p-16",children:[e.jsx(f,{className:"w-16 h-16 mx-auto mb-4 text-gray-600"}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"No Active Flash Sales"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Check back soon for amazing deals!"}),e.jsx(x,{onClick:()=>r("/shop"),variant:"outline",className:"border-primary/40 hover:bg-primary/10 min-h-11",children:"Browse Regular Shop"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:n.map(s=>{const a=s.maxPurchases-s.currentPurchases,t=a/s.maxPurchases*100,m=s.currencyAmount+Math.floor(s.currencyAmount*s.bonusPercentage/100);return e.jsxs(p,{className:"relative overflow-hidden bg-gradient-to-br from-red-500/10 to-orange-500/10 border-red-500/30 hover:border-red-500/50 transition-all duration-300",children:[e.jsxs("div",{className:"absolute top-0 right-0 bg-gradient-to-r from-red-500 to-orange-500 text-white text-xs font-bold px-4 py-1.5 rounded-bl-xl",children:[s.discountPercent,"% OFF"]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:s.packageName}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-orange-500"}),e.jsxs("span",{className:"text-xl font-semibold text-white",children:[m.toLocaleString()," Coins"]})]})]})}),e.jsx("div",{className:"bg-black/30 rounded-lg p-4 border border-gray-700",children:e.jsx(E,{endTime:s.endTime})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Stock Remaining"}),e.jsxs("span",{className:"text-white font-semibold",children:[a,"/",s.maxPurchases]})]}),e.jsx(L,{value:t,className:k("h-2",t<20?"bg-red-900":"bg-gray-700")}),t<20&&e.jsx("p",{className:"text-xs text-red-400 font-semibold animate-pulse",children:"Almost sold out!"})]}),e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Was"}),e.jsxs("p",{className:"text-gray-500 line-through text-lg",children:["$",s.originalPrice]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Now"}),e.jsxs("p",{className:"text-3xl font-bold text-white",children:["$",s.salePrice]})]})]}),s.bonusPercentage>0&&e.jsxs("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-3 flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-primary"}),e.jsxs("span",{className:"text-sm text-primary font-semibold",children:["+",s.bonusPercentage,"% Bonus Coins Included!"]})]}),e.jsxs(x,{onClick:()=>d(s.id),disabled:a<=0,className:"w-full bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 text-white shadow-lg shadow-red-500/25 min-h-11",size:"lg",children:[e.jsx(F,{className:"w-5 h-5 mr-2"}),a<=0?"Sold Out":"Grab This Deal"]})]})]},s.id)})})]}),e.jsx(S,{})]})}export{B as default};
