import{j as e}from"./ui-vendor-_s0klCrL.js";import{u as X,b as v}from"./react-vendor-C7VPsBAG.js";import{u as Z,_ as ee,ax as se,b as S,d as K,f as R,C as l,h as c,a1 as ae,i as d,j as x,k as o,B as p,A as te,aw as re,aa as ie,ab as ne,ac as E,ad as T,a3 as O,am as le,I as f,a8 as U,r as m,a5 as I,av as F}from"./index-BLJ_ytcB.js";import{C as ce}from"./chart-column-CWfcpHvH.js";import{G as q}from"./globe-DHpg7DRg.js";import{C as k}from"./circle-check-big-B1R9t0pA.js";import{E as de}from"./eye-off-BZjFRRGX.js";import{E as oe}from"./eye-CaJoh2v9.js";import{S as H}from"./save-0LRYMEmV.js";import"./utils-vendor-DYGWDIxX.js";function ye(){const[,$]=X(),{isAdmin:Q,isAuthenticated:P}=Z(),{toast:u}=ee(),N=se(),[y,G]=v.useState(""),[a,h]=v.useState(null),[t,j]=v.useState(null),[b,z]=v.useState("overview"),{data:A=[],isLoading:B}=S({queryKey:["/api/series"]}),{data:i,refetch:J}=S({queryKey:["/api/seo/health"]}),{data:D=[]}=S({queryKey:[`/api/series/${a?.id}/chapters`],enabled:!!a?.id}),w=K({mutationFn:async s=>{const n=await R(`/api/admin/series/${a?.id}/seo`,{method:"PATCH",body:JSON.stringify(s)});if(!n.ok)throw new Error(await n.text());return n.json()},onSuccess:()=>{u({title:"SEO metadata updated successfully",variant:"success"}),N.invalidateQueries({queryKey:["/api/series"]}),N.invalidateQueries({queryKey:["/api/seo/health"]})},onError:s=>{u({title:"Failed to update SEO metadata",description:s.message,variant:"error"})}}),C=K({mutationFn:async s=>{const n=await R(`/api/admin/chapters/${t?.id}/seo`,{method:"PATCH",body:JSON.stringify(s)});if(!n.ok)throw new Error(await n.text());return n.json()},onSuccess:()=>{u({title:"Chapter SEO metadata updated successfully",variant:"success"}),N.invalidateQueries({queryKey:[`/api/series/${a?.id}/chapters`]}),N.invalidateQueries({queryKey:["/api/seo/health"]})},onError:s=>{u({title:"Failed to update chapter SEO metadata",description:s.message,variant:"error"})}}),M=(s,n)=>{if(n==="series"){const r=s,g=r.genres?typeof r.genres=="string"?JSON.parse(r.genres):r.genres:[];return{metaTitle:`${r.title} - Read Online | AmourScans`,metaDescription:r.description?r.description.substring(0,155)+(r.description.length>155?"...":""):`Read ${r.title} ${r.type} online. ${g.length>0?"Genres: "+g.slice(0,3).join(", ")+".":""}`,seoKeywords:`${r.title}, ${r.type}, ${g.join(", ")}, read ${r.title} online, ${r.author||""}`.trim()}}else{const r=s,g=A.find(_=>_.id===r.seriesId)?.title||"";return{metaTitle:`${g} Chapter ${r.chapterNumber}${r.title?": "+r.title:""} | AmourScans`,metaDescription:`Read ${g} Chapter ${r.chapterNumber}${r.title?": "+r.title:""} online for free at AmourScans.`}}},V=A.filter(s=>s.title.toLowerCase().includes(y.toLowerCase())||s.author&&s.author.toLowerCase().includes(y.toLowerCase())),W=s=>{w.mutate(s)},Y=s=>{C.mutate(s)},L=()=>{if(b==="series"&&a){const s=M(a,"series");h({...a,...s}),u({title:"Metadata generated",description:"Review and save the auto-generated SEO metadata"})}else if(b==="chapters"&&t){const s=M(t,"chapter");j({...t,...s}),u({title:"Metadata generated",description:"Review and save the auto-generated SEO metadata"})}};return!P||!Q?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-background/95 flex items-center justify-center p-4",children:e.jsxs(l,{className:"max-w-md w-full bg-card/80 backdrop-blur-md border-border/50",children:[e.jsxs(c,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(ae,{className:"w-8 h-8 text-primary"})}),e.jsx(d,{className:"text-2xl",children:"Admin Access Required"}),e.jsx(x,{className:"mt-2",children:"You need admin privileges to access SEO management"})]}),e.jsx(o,{children:e.jsx(p,{onClick:()=>$("/"),className:"w-full",children:"Return to Home"})})]})}):e.jsxs("div",{className:"container mx-auto p-2 sm:p-4 lg:p-6 space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs(p,{variant:"ghost",onClick:()=>$("/admin"),className:"w-fit text-muted-foreground hover:text-primary",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Back to Admin"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"SEO Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Optimize meta titles, descriptions, and indexing for better search rankings"})]}),e.jsxs(p,{onClick:()=>J(),variant:"outline",className:"min-h-11 w-full sm:w-auto",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Refresh Health"]})]})]}),e.jsxs(ie,{value:b,onValueChange:z,children:[e.jsxs(ne,{className:"grid w-full grid-cols-3",children:[e.jsxs(E,{value:"overview",children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Overview"]}),e.jsxs(E,{value:"series",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Series SEO"]}),e.jsxs(E,{value:"chapters",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Chapter SEO"]})]}),e.jsx(T,{value:"overview",className:"space-y-4",children:i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Content Coverage"}),e.jsx(x,{children:"Total indexable content"})]}),e.jsxs(o,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Series:"}),e.jsx("span",{className:"font-bold",children:i.content.totalSeries})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Chapters:"}),e.jsx("span",{className:"font-bold",children:i.content.totalChapters})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Published Chapters:"}),e.jsx("span",{className:"font-bold",children:i.content.publishedChapters})]})]})]}),e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"SEO Metadata Coverage"}),e.jsx(x,{children:"Custom meta tags completion"})]}),e.jsxs(o,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Meta Titles:"}),e.jsx("span",{className:i.seoMetadata.metaTitleCoverage.includes("0.0%")?"text-red-500 font-bold":"text-green-500 font-bold",children:i.seoMetadata.metaTitleCoverage})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Meta Descriptions:"}),e.jsx("span",{className:i.seoMetadata.metaDescriptionCoverage.includes("0.0%")?"text-red-500 font-bold":"text-green-500 font-bold",children:i.seoMetadata.metaDescriptionCoverage})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cover Images:"}),e.jsx("span",{className:"text-green-500 font-bold",children:i.seoMetadata.coverImageCoverage})]})]})]}),e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Indexing Status"}),e.jsx(x,{children:"Search engine visibility"})]}),e.jsxs(o,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Indexable Series:"}),e.jsx("span",{className:"font-bold text-green-500",children:i.indexing.indexableSeries})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"No-Index Series:"}),e.jsx("span",{className:"font-bold text-yellow-500",children:i.indexing.noindexSeries})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Indexable Chapters:"}),e.jsx("span",{className:"font-bold text-green-500",children:i.indexing.indexableChapters})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"No-Index Chapters:"}),e.jsx("span",{className:"font-bold text-yellow-500",children:i.indexing.noindexChapters})]})]})]}),e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Recommendations"}),e.jsx(x,{children:"Actionable SEO improvements"})]}),e.jsx(o,{children:i.recommendations.length>0?e.jsx("ul",{className:"space-y-2",children:i.recommendations.map((s,n)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-yellow-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:s})]},n))}):e.jsxs("div",{className:"flex items-center gap-2 text-green-500",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:"All SEO requirements met!"})]})})]})]})}),e.jsx(T,{value:"series",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs(l,{className:"lg:col-span-1",children:[e.jsxs(c,{children:[e.jsx(d,{children:"Series List"}),e.jsxs("div",{className:"relative mt-2",children:[e.jsx(le,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(f,{placeholder:"Search series...",value:y,onChange:s=>G(s.target.value),className:"pl-8"})]})]}),e.jsx(o,{className:"max-h-[600px] overflow-y-auto",children:B?e.jsx("p",{children:"Loading..."}):e.jsx("div",{className:"space-y-2",children:V.map(s=>e.jsxs("div",{onClick:()=>h(s),className:`p-3 rounded cursor-pointer transition-colors ${a?.id===s.id?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:[e.jsx("div",{className:"font-medium truncate",children:s.title}),e.jsxs("div",{className:"text-xs opacity-75 flex items-center gap-2 mt-1",children:[s.metaTitle?e.jsx(k,{className:"w-3 h-3 text-green-500"}):e.jsx(O,{className:"w-3 h-3 text-yellow-500"}),e.jsx("span",{children:s.metaTitle?"SEO Configured":"Needs SEO"})]})]},s.id))})})]}),e.jsxs(l,{className:"lg:col-span-2",children:[e.jsx(c,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(d,{children:a?a.title:"Select a Series"}),e.jsx(x,{children:"Edit SEO metadata for better search rankings"})]}),a&&e.jsxs(p,{onClick:L,variant:"outline",size:"sm",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Auto-Generate"]})]})}),e.jsx(o,{children:a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"metaTitle",children:"Meta Title"}),e.jsx(f,{id:"metaTitle",value:a.metaTitle||"",onChange:s=>h({...a,metaTitle:s.target.value}),placeholder:`${a.title} - Read Online | AmourScans`,maxLength:60}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(a.metaTitle||"").length,"/60 characters (optimal: 50-60)"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"metaDescription",children:"Meta Description"}),e.jsx(I,{id:"metaDescription",value:a.metaDescription||"",onChange:s=>h({...a,metaDescription:s.target.value}),placeholder:"Enter a compelling description for search results...",rows:3,maxLength:160}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(a.metaDescription||"").length,"/160 characters (optimal: 150-160)"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"seoKeywords",children:"SEO Keywords"}),e.jsx(f,{id:"seoKeywords",value:a.seoKeywords||"",onChange:s=>h({...a,seoKeywords:s.target.value}),placeholder:"keyword1, keyword2, keyword3"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Comma-separated keywords for search optimization"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"canonicalUrl",children:"Canonical URL (Optional)"}),e.jsx(f,{id:"canonicalUrl",value:a.canonicalUrl||"",onChange:s=>h({...a,canonicalUrl:s.target.value}),placeholder:"Leave empty for auto-generation"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Custom canonical URL (defaults to /manga/",a.id,")"]})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(m,{children:"Search Engine Indexing"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.robotsNoindex==="true"?"Hidden from search engines":"Visible to search engines"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.robotsNoindex==="true"?e.jsx(de,{className:"w-4 h-4 text-yellow-500"}):e.jsx(oe,{className:"w-4 h-4 text-green-500"}),e.jsx(F,{checked:a.robotsNoindex!=="true",onCheckedChange:s=>h({...a,robotsNoindex:s?"false":"true"})})]})]}),e.jsxs(p,{onClick:()=>W({metaTitle:a.metaTitle,metaDescription:a.metaDescription,seoKeywords:a.seoKeywords,canonicalUrl:a.canonicalUrl,robotsNoindex:a.robotsNoindex}),className:"w-full",disabled:w.isPending,children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),w.isPending?"Saving...":"Save SEO Metadata"]})]}):e.jsx("p",{className:"text-center text-muted-foreground py-12",children:"Select a series from the list to edit its SEO metadata"})})]})]})}),e.jsx(T,{value:"chapters",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs(l,{className:"lg:col-span-1",children:[e.jsxs(c,{children:[e.jsx(d,{children:"Chapters"}),e.jsx(x,{children:a?`${a.title}`:"Select a series first"})]}),e.jsx(o,{className:"max-h-[600px] overflow-y-auto",children:a?D.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No chapters available"}):e.jsx("div",{className:"space-y-2",children:D.map(s=>e.jsxs("div",{onClick:()=>j(s),className:`p-3 rounded cursor-pointer transition-colors ${t?.id===s.id?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:[e.jsxs("div",{className:"font-medium",children:["Chapter ",s.chapterNumber]}),s.title&&e.jsx("div",{className:"text-xs opacity-75",children:s.title}),e.jsxs("div",{className:"text-xs opacity-75 flex items-center gap-2 mt-1",children:[s.metaTitle?e.jsx(k,{className:"w-3 h-3 text-green-500"}):e.jsx(O,{className:"w-3 h-3 text-yellow-500"}),e.jsx("span",{children:s.metaTitle?"SEO Configured":"Needs SEO"})]})]},s.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select a series from the Series SEO tab first"})})]}),e.jsxs(l,{className:"lg:col-span-2",children:[e.jsx(c,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(d,{children:t?`Chapter ${t.chapterNumber}`:"Select a Chapter"}),e.jsx(x,{children:"Edit chapter SEO metadata"})]}),t&&e.jsxs(p,{onClick:L,variant:"outline",size:"sm",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Auto-Generate"]})]})}),e.jsx(o,{children:t?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"chapterMetaTitle",children:"Meta Title"}),e.jsx(f,{id:"chapterMetaTitle",value:t.metaTitle||"",onChange:s=>j({...t,metaTitle:s.target.value}),placeholder:`Chapter ${t.chapterNumber}${t.title?": "+t.title:""}`,maxLength:60}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(t.metaTitle||"").length,"/60 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"chapterMetaDescription",children:"Meta Description"}),e.jsx(I,{id:"chapterMetaDescription",value:t.metaDescription||"",onChange:s=>j({...t,metaDescription:s.target.value}),placeholder:"Enter description for this chapter...",rows:3,maxLength:160}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(t.metaDescription||"").length,"/160 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"chapterCanonicalUrl",children:"Canonical URL (Optional)"}),e.jsx(f,{id:"chapterCanonicalUrl",value:t.canonicalUrl||"",onChange:s=>j({...t,canonicalUrl:s.target.value}),placeholder:"Leave empty for auto-generation"})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(m,{children:"Search Engine Indexing"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.robotsNoindex==="true"?"Hidden from search engines":"Visible to search engines"})]}),e.jsx(F,{checked:t.robotsNoindex!=="true",onCheckedChange:s=>j({...t,robotsNoindex:s?"false":"true"})})]}),e.jsxs(p,{onClick:()=>Y({metaTitle:t.metaTitle,metaDescription:t.metaDescription,canonicalUrl:t.canonicalUrl,robotsNoindex:t.robotsNoindex}),className:"w-full",disabled:C.isPending,children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),C.isPending?"Saving...":"Save Chapter SEO"]})]}):e.jsx("p",{className:"text-center text-muted-foreground py-12",children:"Select a chapter from the list to edit its SEO metadata"})})]})]})})]})]})}export{ye as default};
