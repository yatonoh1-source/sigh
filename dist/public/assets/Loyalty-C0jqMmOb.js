import{j as s}from"./ui-vendor-_s0klCrL.js";import{u as T,b as n}from"./react-vendor-C7VPsBAG.js";import{u as B,N as b,ae as x,S as E,B as A,A as D,C as h,h as $,ah as j,i as R,k as p,F as d,an as U,a2 as F}from"./index-BLJ_ytcB.js";import{P as G}from"./progress-CS8SLfk3.js";import{T as N}from"./trophy-C_Kv6fHf.js";import{C as f}from"./crown-Cq9T_P0l.js";import{G as J}from"./gift-lTXnbkoc.js";import"./utils-vendor-DYGWDIxX.js";function Q(){const[,o]=T(),{isAuthenticated:c,isLoading:m}=B(),[r,v]=n.useState(null),[u,w]=n.useState([]),[C,P]=n.useState(!0),y=n.useCallback(async()=>{try{const[e,t]=await Promise.all([fetch("/api/loyalty/my-status",{credentials:"include"}),fetch("/api/loyalty/tiers",{credentials:"include"})]);if(e.ok){const l=await e.json();v(l)}if(t.ok){const l=await t.json();w(l)}}catch{}finally{P(!1)}},[]);n.useEffect(()=>{!m&&!c?o("/login?returnTo=/loyalty"):c&&y()},[m,c,o,y]);const L=e=>{try{return JSON.parse(e)}catch{return[]}},g=e=>e.toLowerCase().includes("bronze")?s.jsx(j,{className:"w-8 h-8"}):e.toLowerCase().includes("silver")?s.jsx(N,{className:"w-8 h-8"}):e.toLowerCase().includes("gold")?s.jsx(f,{className:"w-8 h-8"}):e.toLowerCase().includes("platinum")||e.toLowerCase().includes("diamond")?s.jsx(f,{className:"w-8 h-8"}):s.jsx(J,{className:"w-8 h-8"});if(m||C)return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[s.jsx(b,{}),s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-20",children:[s.jsx(x,{className:"h-12 w-96 mb-6 bg-gray-800"}),s.jsx(x,{className:"h-64 mb-6 bg-gray-800"}),s.jsx(x,{className:"h-96 bg-gray-800"})]})]});if(!c)return o("/login?returnTo=/loyalty"),null;const a=r?.tier,i=u.find(e=>e.minPoints>(r?.points||0)),k=i?i.minPoints-(r?.points||0):0,S=i?(r?.points||0)/i.minPoints*100:100;return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[s.jsx(E,{title:"Loyalty Program - Earn Points & Unlock Exclusive Rewards",description:"Join the AmourScans Loyalty Program to earn points with every purchase. Unlock exclusive rewards, coin bonuses, discounts, and special perks as you level up through tiers.",keywords:"loyalty program, earn points, manga rewards, loyalty tiers, exclusive perks, coin bonuses"}),s.jsx(b,{}),s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-16",children:[s.jsxs(A,{variant:"ghost",onClick:()=>o("/"),className:"min-h-11 w-fit text-muted-foreground hover:text-primary mb-4",children:[s.jsx(D,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsxs("div",{className:"text-center mb-12",children:[s.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-full mb-6",children:[s.jsx(N,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"text-sm font-semibold text-primary",children:"Loyalty Program"})]}),s.jsx("h1",{className:"text-3xl sm:text-4xl lg:text-6xl font-bold text-white mb-4",children:"Your Loyalty Status"}),s.jsx("p",{className:"text-gray-400 text-base sm:text-lg max-w-2xl mx-auto",children:"Earn points with every purchase and unlock exclusive rewards"})]}),s.jsxs(h,{className:"bg-gradient-to-br from-gray-900 to-gray-800 border-2 mb-8",style:{borderColor:a?.badgeColor||"#6b7280"},children:[s.jsx($,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"p-4 rounded-xl",style:{backgroundColor:`${a?.badgeColor||"#6b7280"}20`},children:s.jsx("div",{style:{color:a?.badgeColor||"#9ca3af"},children:a?g(a.name):s.jsx(j,{className:"w-8 h-8"})})}),s.jsxs("div",{children:[s.jsx(R,{className:"text-3xl text-white",children:a?.name||"No Tier"}),s.jsxs("p",{className:"text-gray-400 mt-1",children:[r?.points.toLocaleString()||0," Points"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-400",children:"Lifetime Points"}),s.jsx("p",{className:"text-2xl font-bold text-white",children:r?.lifetimePoints.toLocaleString()||0})]})]})}),s.jsxs(p,{className:"space-y-4",children:[i&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsxs("span",{className:"text-gray-400",children:["Progress to ",i.name]}),s.jsxs("span",{className:"text-white font-semibold",children:[k.toLocaleString()," points needed"]})]}),s.jsx(G,{value:S,className:"h-3"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-700",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-amber-500",children:["+",a?.coinBonusPercentage||0,"%"]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Coin Bonus"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-green-500",children:[a?.discountPercentage||0,"%"]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Discount"})]})]}),a&&s.jsxs("div",{className:"bg-primary/10 border border-primary/20 rounded-lg p-4",children:[s.jsx("p",{className:"text-sm font-semibold text-primary mb-2",children:"Your Perks:"}),s.jsx("div",{className:"space-y-1",children:L(a.perks).map((e,t)=>s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-primary"}),e]},t))})]})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"All Tiers"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map(e=>{const t=e.id===a?.id,l=(r?.points||0)<e.minPoints;return s.jsxs(h,{className:`relative overflow-hidden transition-all ${t?"border-2 scale-105":l?"bg-gray-900/30 border-gray-800 opacity-60":"bg-gray-900/50 border-gray-800"}`,style:t?{borderColor:e.badgeColor}:{},children:[t&&s.jsx(d,{className:"absolute top-4 right-4 text-white border-0",style:{backgroundColor:e.badgeColor},children:"Current"}),s.jsxs(p,{className:"p-6",children:[s.jsx("div",{className:"inline-flex p-3 rounded-xl mb-4",style:{backgroundColor:`${e.badgeColor}20`},children:s.jsx("div",{style:{color:e.badgeColor},children:g(e.name)})}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:e.name}),s.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:[e.minPoints.toLocaleString(),e.maxPoints?` - ${e.maxPoints.toLocaleString()}`:"+"," points"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-400",children:"Coin Bonus"}),s.jsxs("span",{className:"text-amber-500 font-semibold",children:["+",e.coinBonusPercentage,"%"]})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-400",children:"Discount"}),s.jsxs("span",{className:"text-green-500 font-semibold",children:[e.discountPercentage,"%"]})]})]})]})]},e.id)})})]}),s.jsx(h,{className:"bg-gradient-to-r from-primary/10 to-accent/10 border-primary/30",children:s.jsxs(p,{className:"p-6 text-center",children:[s.jsx(U,{className:"w-12 h-12 mx-auto mb-4 text-primary"}),s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Earn Loyalty Points"}),s.jsx("p",{className:"text-gray-400 mb-4",children:"Earn points with every coin purchase and subscription"}),s.jsxs("div",{className:"flex gap-4 justify-center flex-wrap",children:[s.jsx(d,{variant:"outline",className:"border-primary/30 text-primary",children:"1 point per $1 spent"}),s.jsx(d,{variant:"outline",className:"border-primary/30 text-primary",children:"Bonus multipliers on special events"}),s.jsx(d,{variant:"outline",className:"border-primary/30 text-primary",children:"Double points on subscriptions"})]})]})})]}),s.jsx(F,{})]})}export{Q as default};
