import{j as e}from"./ui-vendor-_s0klCrL.js";import{u as F,b as o}from"./react-vendor-C7VPsBAG.js";import{u as U,J,Z as M,_ as V,g as c,N,$ as g,B as a,A as Y,a0 as b,C as w,k as C,F as f,Y as Z}from"./index-BLJ_ytcB.js";import{A as k,a as A,b as D,c as R,d as S,e as L,f as $,g as P}from"./alert-dialog-CQ2ww59i.js";import{i as _}from"./utils-vendor-DYGWDIxX.js";function X(){const{isAuthenticated:j,isLoading:H}=U(),{progressList:r,isLoading:l}=J(j),{deleteProgress:v}=M(),[,t]=F(),{toast:d}=V(),[I,m]=o.useState(!1),[T,x]=o.useState(!1),[n,p]=o.useState(null),[h,y]=o.useState(!1);if(H)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(c,{className:"w-12 h-12 text-primary mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})});if(!j)return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(N,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-20 text-center",children:[e.jsx(g,{className:"w-20 h-20 text-primary/50 mx-auto mb-6"}),e.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:"Sign in to view your history"}),e.jsx("p",{className:"text-muted-foreground mb-8",children:"Create an account or sign in to track your reading history and continue where you left off."}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsx(a,{onClick:()=>t("/login"),className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90 min-h-11",children:"Sign In"}),e.jsx(a,{onClick:()=>t("/signup"),variant:"outline",className:"min-h-11",children:"Create Account"})]})]})]});const B=(s,i)=>{p({id:s,title:i}),x(!0)},z=()=>{n&&(v(n.id),d({title:"History cleared",description:`Removed "${n.title}" from your reading history.`}),x(!1),p(null))},O=(s,i,u)=>{t(`/manga/${s}`)},E=async()=>{y(!0);try{for(const s of r)await v(s.series.id);d({title:"History cleared",description:`Removed all ${r.length} series from your reading history.`}),m(!1)}catch{d({title:"Error",description:"Failed to clear history. Please try again.",variant:"error"})}finally{y(!1)}};return e.jsxs("div",{className:"min-h-screen bg-background w-full overflow-x-hidden",children:[e.jsx(N,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs(a,{variant:"ghost",onClick:()=>t("/"),className:"w-fit text-muted-foreground hover:text-primary mb-4",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-primary to-accent rounded-lg flex items-center justify-center shadow-lg",children:e.jsx(g,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold bg-gradient-to-r from-primary via-accent to-purple-400 bg-clip-text text-transparent",children:"Reading History"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[r.length," ",(r.length===1,"series")," in progress"]})]})]}),!l&&r.length>0&&e.jsxs(a,{variant:"outline",size:"sm",className:"min-h-11 gap-2 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>m(!0),"aria-label":"Clear all reading history",children:[e.jsx(b,{className:"w-4 h-4"}),"Clear All"]})]}),l&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(c,{className:"w-12 h-12 text-primary mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading your history..."})]}),!l&&r.length===0&&e.jsx(w,{className:"bg-card/80 backdrop-blur-md border-border/50",children:e.jsxs(C,{className:"py-16 text-center",children:[e.jsx(g,{className:"w-16 h-16 text-muted-foreground/50 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:"No reading history yet"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Start reading manga to track your progress and continue where you left off!"}),e.jsx(a,{onClick:()=>t("/browse"),className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90 min-h-11",children:"Browse Manga"})]})}),!l&&r.length>0&&e.jsx("div",{className:"space-y-4",children:r.map(s=>e.jsx(w,{className:"group bg-card/80 backdrop-blur-md border-border/50 hover:border-primary/60 transition-all duration-300 hover:shadow-lg hover:shadow-primary/20",children:e.jsx(C,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative w-20 sm:w-32 h-28 sm:h-44 flex-shrink-0 overflow-hidden rounded-lg cursor-pointer",onClick:()=>t(`/manga/${s.series.id}`),children:[s.series.coverImageUrl?e.jsx("img",{src:s.series.coverImageUrl,alt:s.series.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-muted/80 to-muted/60 flex items-center justify-center",children:e.jsx(c,{className:"w-8 h-8 text-muted-foreground/50"})}),s.series.status&&e.jsx(f,{className:"absolute top-2 left-2 bg-primary/90 backdrop-blur-sm text-xs",children:s.series.status})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2 mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:()=>t(`/manga/${s.series.id}`),children:[e.jsx("h3",{className:"font-bold text-lg sm:text-xl text-foreground group-hover:text-primary transition-colors mb-1 line-clamp-2",children:s.series.title}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(()=>{const i=typeof s.series.genres=="string"?JSON.parse(s.series.genres):s.series.genres;return Array.isArray(i)&&i.slice(0,3).map(u=>e.jsx(f,{variant:"outline",className:"text-xs",children:u},u))})()})]}),e.jsx(a,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-destructive flex-shrink-0",onClick:()=>B(s.series.id,s.series.title),"aria-label":`Remove ${s.series.title} from reading history`,children:e.jsx(b,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[s.chapterId&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(f,{variant:"secondary",className:"bg-primary/20 text-primary",children:"Reading in progress"}),e.jsxs("span",{className:"text-muted-foreground",children:["Page ",s.lastReadPage||1]})]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Last read ",s.lastReadAt?_(new Date(s.lastReadAt),{addSuffix:!0}):"Recently"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{size:"sm",className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90 min-h-11",onClick:()=>O(s.series.id,s.chapterId),children:[e.jsx(c,{className:"w-4 h-4 mr-2"}),"Continue Reading"]}),e.jsx(a,{size:"sm",variant:"outline",className:"min-h-11",onClick:()=>t(`/manga/${s.series.id}`),children:"View Details"})]})]})]})})},s.id))})]}),e.jsx(k,{open:I,onOpenChange:m,children:e.jsxs(A,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"Clear all reading history?"}),e.jsxs(S,{children:["This will remove all ",r.length," series from your reading history. This action cannot be undone."]})]}),e.jsxs(L,{children:[e.jsx($,{disabled:h,children:"Cancel"}),e.jsx(P,{onClick:E,disabled:h,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:h?"Clearing...":"Clear All"})]})]})}),e.jsx(k,{open:T,onOpenChange:x,children:e.jsxs(A,{children:[e.jsxs(D,{children:[e.jsx(R,{children:"Remove from reading history?"}),e.jsxs(S,{children:['Remove "',n?.title,'" from your reading history? This action cannot be undone.']})]}),e.jsxs(L,{children:[e.jsx($,{children:"Cancel"}),e.jsx(P,{onClick:z,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remove"})]})]})})]})}export{X as default};
