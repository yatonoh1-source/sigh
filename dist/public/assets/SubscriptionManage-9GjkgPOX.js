import{j as e}from"./ui-vendor-_s0klCrL.js";import{u as k,b as A}from"./react-vendor-C7VPsBAG.js";import{c as E,u as P,_ as L,b as F,d as b,q as j,N as x,ae as y,C as n,B as t,A as q,h as u,i as h,j as R,F as T,k as g,ao as M,a3 as B,af as N,an as X,ap as Y,a2 as H}from"./index-BLJ_ytcB.js";import{A as K,a as O,b as Q,c as U,d as I,e as V,f as W,g as z}from"./alert-dialog-CQ2ww59i.js";import{C as v}from"./crown-Cq9T_P0l.js";import"./utils-vendor-DYGWDIxX.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=E("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);function re(){const[,c]=k(),{isAuthenticated:f,isLoading:w}=P(),{toast:i}=L(),[C,l]=A.useState(!1),{data:a,isLoading:S}=F({queryKey:["/api/subscriptions/current"],queryFn:async()=>{const s=await fetch("/api/subscriptions/current",{credentials:"include"});if(s.status===404)return null;if(!s.ok)throw new Error("Failed to fetch subscription");return s.json()},enabled:f}),o=b({mutationFn:async()=>{const s=await fetch("/api/subscriptions/cancel",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include"});if(!s.ok){const r=await s.json();throw new Error(r.message||"Failed to cancel subscription")}return s.json()},onSuccess:()=>{j.invalidateQueries({queryKey:["/api/subscriptions/current"]}),i({title:"Subscription Cancelled",description:"Your subscription will remain active until the end of the billing period."}),l(!1)},onError:s=>{i({title:"Error",description:s.message,variant:"error"})}}),d=b({mutationFn:async()=>{const s=await fetch("/api/subscriptions/reactivate",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"include"});if(!s.ok){const r=await s.json();throw new Error(r.message||"Failed to reactivate subscription")}return s.json()},onSuccess:()=>{j.invalidateQueries({queryKey:["/api/subscriptions/current"]}),i({title:"Subscription Reactivated",description:"Your subscription will continue automatically."})},onError:s=>{i({title:"Error",description:s.message,variant:"error"})}});if(w||S)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(x,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-20",children:[e.jsx(y,{className:"h-12 w-96 mx-auto mb-12 bg-gray-800"}),e.jsx(y,{className:"h-96 bg-gray-800"})]})]});if(!a)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(x,{}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-20",children:e.jsxs(n,{className:"bg-gray-900/50 border-gray-800 text-center p-12",children:[e.jsx(v,{className:"w-16 h-16 mx-auto mb-4 text-gray-600"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Active Subscription"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Subscribe to a plan to unlock premium features"}),e.jsx(t,{onClick:()=>c("/subscriptions"),className:"bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90",children:"View Plans"})]})})]});const D=(s=>{try{return JSON.parse(s)}catch{return[]}})(a.features),p=a.status==="active",m=a.cancelAtPeriodEnd==="true";return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-black to-gray-900",children:[e.jsx(x,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-16",children:[e.jsxs(t,{variant:"ghost",onClick:()=>c("/"),className:"w-fit text-muted-foreground hover:text-primary mb-4",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Manage Subscription"}),e.jsx("p",{className:"text-gray-400",children:"View and manage your subscription details"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(n,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(h,{className:"text-white flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5 text-primary"}),a.packageName]}),e.jsxs(R,{children:["$",a.priceUSD,"/month"]})]}),e.jsx(T,{variant:p?"default":"secondary",className:p?"bg-green-500/20 text-green-500 border-green-500/30":"",children:a.status})]})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(M,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Current Period"}),e.jsxs("p",{className:"text-white font-medium",children:[new Date(a.currentPeriodStart).toLocaleDateString()," - ",new Date(a.currentPeriodEnd).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(J,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Next Billing"}),e.jsx("p",{className:"text-white font-medium",children:m?"N/A (Cancelled)":new Date(a.currentPeriodEnd).toLocaleDateString()})]})]})]}),m&&e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(B,{className:"w-5 h-5 text-amber-500 shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-amber-500 font-medium",children:"Subscription Ending"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Your subscription will end on ",new Date(a.currentPeriodEnd).toLocaleDateString(),". Reactivate to continue enjoying premium benefits."]})]})]})]})]}),e.jsxs(n,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(u,{children:e.jsx(h,{className:"text-white",children:"Features Included"})}),e.jsx(g,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:D.map((s,r)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-primary shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm text-gray-300",children:s})]},r))})})]}),e.jsxs(n,{className:"bg-gray-900/50 border-gray-800",children:[e.jsx(u,{children:e.jsx(h,{className:"text-white",children:"Subscription Actions"})}),e.jsxs(g,{className:"space-y-3",children:[e.jsxs(t,{onClick:()=>c("/subscriptions"),variant:"outline",className:"w-full justify-start border-gray-700 hover:bg-gray-800",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Upgrade Plan"]}),m?e.jsxs(t,{onClick:()=>d.mutate(),disabled:d.isPending,variant:"outline",className:"w-full justify-start border-green-500/30 text-green-500 hover:bg-green-500/10",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),d.isPending?"Reactivating...":"Reactivate Subscription"]}):e.jsxs(t,{onClick:()=>l(!0),variant:"outline",className:"w-full justify-start border-red-500/30 text-red-500 hover:bg-red-500/10",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Cancel Subscription"]})]})]})]})]}),e.jsx(K,{open:C,onOpenChange:l,children:e.jsxs(O,{className:"bg-gray-900 border-gray-800",children:[e.jsxs(Q,{children:[e.jsx(U,{className:"text-white",children:"Cancel Subscription?"}),e.jsxs(I,{className:"text-gray-400",children:["Your subscription will remain active until the end of the current billing period on ",new Date(a.currentPeriodEnd).toLocaleDateString(),". You can reactivate anytime before then."]})]}),e.jsxs(V,{children:[e.jsx(W,{className:"bg-gray-800 border-gray-700 text-white hover:bg-gray-700",children:"Keep Subscription"}),e.jsx(z,{onClick:()=>o.mutate(),disabled:o.isPending,className:"bg-red-500 hover:bg-red-600",children:o.isPending?"Cancelling...":"Cancel Subscription"})]})]})}),e.jsx(H,{})]})}export{re as default};
